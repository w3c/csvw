<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width,initial-scale=1" name="viewport" />
    <title>Metadata Vocabulary for Tabular Data</title>
    <script class="remove" src="https://www.w3.org/Tools/respec/respec-w3c-common">
		</script>
    <script class="remove">
var respecConfig = {
    localBiblio: {
      "tabular-data-model": {
          "authors": [
            "Jeni Tennison",
            "Gregg Kellogg"
          ],
          "title": "Model for Tabular Data and Metadata on the Web",
          "href" : "http://www.w3.org/TR/2014/WD-tabular-data-model-20150108/",
          "rawDate": "2015-01-08",
          "status" : "WD",
          "publisher": "W3C"
      },
      "csv2json": {
          "authors": [
            "Jeremy Tandy",
            "Ivan Herman"
          ],
          "title": "Generating JSON from Tabular Data on the Web",
          "href" : "http://www.w3.org/TR/2015/WD-csv2json-20150108/",
          "rawDate": "2015-01-08",
          "status" : "WD",
          "publisher": "W3C"
      },
      "csv2rdf": {
          "authors": [
            "Jeremy Tandy",
            "Ivan Herman",
            "Gregg Kellogg"
          ],
          "title": "Generating RDF from Tabular Data on the Web",
          "href" : "http://www.w3.org/TR/2015/WD-csv2rdf-20150108/",
          "rawDate": "2015-01-08",
          "status" : "WD",
          "publisher": "W3C"
      },
      "csvw-context": {
          "authors": [
            "Gregg Kellogg"
          ],
          "title": "Metadata Vocabulary for Tabular Data",
          "href" : "http://www.w3.org/ns/csvw",
          "publisher": "W3C"
      }
    },
    specStatus: "ED",
    shortName: "tabular-metadata",
    //publishDate:  "2014-03-27",
    previousPublishDate: "2015-01-08",
    previousMaturity: "WD",
    previousURI: "http://www.w3.org/TR/2014/WD-tabular-metadata-20150108/",
    edDraftURI: "http://w3c.github.io/csvw/metadata/",
    // lcEnd: "3000-01-01",
    // crEnd: "3000-01-01",
    editors: [{ 
      name: "Rufus Pollock", 
      url: "http://rufuspollock.org/",
      company: "Open Knowledge", 
      companyURL: "https://okfn.org/",
      w3cid: "62304"
    }, {
      name: "Jeni Tennison",
      company: "Open Data Institute",
      companyURL: "http://theodi.org/",
      w3cid: "33715"
    }, { 
      name: "Gregg Kellogg", 
      url: "http://greggkellogg.net/",
      company: "Kellogg Associates", 
      companyURL: "http://kellogg-assoc.com/",
      w3cid: "44770"
    }],
    wg: "CSV on the Web Working Group",
    wgURI: "http://www.w3.org/2013/csvw/",
    wgPublicList: "public-csv-wg",
    wgPatentURI: "http://www.w3.org/2004/01/pp-impl/68238/status",
    otherLinks: [{
      key: "Repository",
      data: [{
          value: "We are on Github",
          href: "https://github.com/w3c/csvw"
      }, {
          value: "File a bug",
          href: "https://github.com/w3c/csvw"
      }]
      }, {
      key: "Changes",
        data: [{
          value: "Diff to previous version",
          href: "diff-20150108.html"
        }, {
          value: "Commit history",
          href: "https://github.com/w3c/csvw/commits/gh-pages"
      }]
    }],
    inlineCSS: true,
    issueBase: "https://github.com/w3c/csvw/issues/",
    noIDLIn: true,
    noLegacyStyle: false
    };
    </script>
    <script class="remove">
    function escapeContent(doc, content) {
          var utils = require("core/utils");
    // perform transformations to make it render and prettier
      return utils.xmlEscape(content);
    }
    </script>
    <style>
      td, th { padding-left: 1em; padding-right: 1em; }
      tbody tr th { text-align: left; }
      ol.algorithm {
        counter-reset: numsection;
        list-style-type: none;
      }
      ol.algorithm > li {
        margin: 1em -1em;
        text-indent: -1em;
      }
      ol.algorithm > li:before {
        font-weight: bold;
        counter-increment: numsection;
        content: counters(numsection, ".") " ";
      }
      ol.algorithm>li>p {text-indent: 0em}
      ol.algorithm>li>p:first-child {position: relative; display: inline;}
    </style>
  </head>
  <body>
    <section id="abstract">
      <p>
        Validation, conversion, display and search of tabular data on the web requires additional metadata that describes how the data should be interpreted. This document defines a vocabulary for metadata that annotates tabular data. This can be used to provide metadata at various levels, from collections of data from CSV documents and how they relate to each other down to individual cells within a table.
      </p>
    </section>
    <section id="sotd">
      <p>
        The CSV on the Web Working Group was chartered to produce a Recommendation "Access methods for CSV Metadata" as well as Recommendations for "Metadata vocabulary for CSV data" and "Mapping mechanism to transforming CSV into various Formats (e.g., RDF, JSON, or XML)". This document aims to primarily satisfy the second of those Recommendations.
      </p>
    </section>
    <section>
      <h2>Introduction</h2>
      <p>
        Interpreting tabular data that is available on the web, particularly as CSV, usually requires additional metadata. As an example, say that the following CSV file were available at <code>http://example.org/tree-ops.csv</code>
      </p>
      <pre class="example">
GID,On Street,Species,Trim Cycle,Inventory Date
1,ADDISON AV,Celtis australis,Large Tree Routine Prune,10/18/2010
2,EMERSON ST,Liquidambar styraciflua,Large Tree Routine Prune,6/2/2010
3,EMERSON ST,Liquidambar styraciflua,Large Tree Routine Prune,6/2/2010
      </pre>
      <p>
        A human consumer of this data might be able to figure out the meaning of the different columns, particularly if there were some additional human-readable documentation made available. Automated processors would have a much harder time; realistically they would be limited to displaying the information in a table. Making available machine-readable metadata helps with the interpretation of the tabular data. For example, say that the following metadata file were available at <code>http://example.org/trees-ops.csv-metadata.json</code>:
      </p>
      <pre class="example highlight">
{
  "url": "tree-ops.csv",
  "@context": ["http://www.w3.org/ns/csvw", {"@language": "en"}],
  "dc:title": "Tree Operations",
  "dc:keywords": ["tree", "street", "maintenance"],
  "dc:publisher": {
    "schema:name": "Example Municipality",
    "schema:url": {"@id": "http://example.org"}
  },
  "dc:license": {"@id": "http://opendefinition.org/licenses/cc-by/"},
  "dc:modified": {"@value": "2010-12-31", "@type": "xsd:date"},
  "tableSchema": {
    "columns": [{
      "name": "GID",
      "title": [
        "GID",
        "Generic Identifier"
      ],
      "dc:description": "An identifier for the operation on a tree.",
      "datatype": "string",
      "required": true
    }, {
      "name": "on_street",
      "title": "On Street",
      "dc:description": "The street that the tree is on.",
      "datatype": "string"
    }, {
      "name": "species",
      "title": "Species",
      "dc:description": "The species of the tree.",
      "datatype": "string"
    }, {
      "name": "trim_cycle",
      "title": "Trim Cycle",
      "dc:description": "The operation performed on the tree.",
      "datatype": "string"
    }, {
      "name": "inventory_date",
      "title": "Inventory Date",
      "dc:description": "The date of the operation that was performed.",
      "datatype": {
        "base": "date",
        "format": "M/d/yyyy"
      }
    }],
    "primaryKey": "GID",
    "aboutUrl": "#gid-{GID}"
  }
}
      </pre>
      <p>
        Given the location of the CSV file, this metadata document can be located by appending <code>-metadata.json</code> to the URL (as described in <a href="http://w3c.github.io/csvw/syntax/#standard-file-metadata">Model for Tabular Data and Metadata on the Web</a>). It provides information for different types of applications:
      </p>
      <ul>
        <li><dfn>Viewers</dfn> can use the indicated metadata to provide a more user-friendly or human-readable view of the CSV file, which might include displaying it in a table or as graphs or charts.</li>
        <li><dfn>Data entry tools</dfn> can use the metadata to prompt people to supply information that is added to a CSV file</li>
        <li><dfn>Validators</dfn> can check that the labels of the columns in the metadata file match those in the CSV file, that the values in the columns are of the right type and in the right format, and that values in the <code>GID</code> column are all present and unique.</li>
        <li><dfn>Converters</dfn> can use the metadata to map the CSV data into other formats such as JSON, RDF and XML, or into databases or statistical applications, in intelligent ways.</li>
        <li><dfn>Data Aggregators</dfn> can use the indicated metadata, such as descriptions, titles, modification dates and licences, to enable more intelligent retrieval of relevant data on the web.</li>
      </ul>
      <p class="note">
        Implementations may fulfil one or more of these functions. In particular, <a>Converters</a> may or may not act as a <a title="Validators">Validator</a> (perhaps through the setting of a flag), and check the data that they are converting to ensure that it is complant with the schema. If a Converter does not also act as a <a title="validators">Validator</a> it may produce invalid output.
      </p>
      <p>
        The <a href="http://www.w3.org/TR/tabular-data-model/">Model for Tabular Data and Metadata on the Web</a> specification defines an <a href="http://w3c.github.io/csvw/syntax/#annotated-tabular-data-model">Annotated Tabular Data Model</a> in which tables, columns, rows and cells can be annotated with annotations, and a <a href="http://w3c.github.io/csvw/syntax/#grouped-tabular-data-model">Grouped Tabular Data Model</a> in which a group of tables is annotated. That specification also describes <a href="http://w3c.github.io/csvw/syntax/#locating-metadata">how to locate metadata</a> about a given CSV file.
      </p>
      <p>
        This document defines the format and structure of metadata documents, and how these are interpreted to create an Annotated Tabular Data Model. It also defines how to validate tabular data based on some of these annotations. The metadata format is based on a dialect of [[!JSON-LD]] as defined in <a href="#json-ld-dialect" class="sectionRef"></a>. This metadata can be expressed as an RDF graph. However, all applications that conform to this specification (including <a>validators</a> and applications that read or convert tabular data) MUST read the JSON-based format described in this document.
      </p>
    </section>
    <section>
      <h2>Annotating Tables</h2>
      <p>
        The metadata defined in this specification is used to provide annotations on an <a href="http://w3c.github.io/csvw/syntax/#dfn-annotated-table" class="externalDFN">annotated table</a> or <a href="http://w3c.github.io/csvw/syntax/#dfn-group-of-tables" class="externalDFN">group of tables</a>, as defined in [[!tabular-data-model]]. Annotated tables form the basis for all further processing, such as validating, converting or displaying the tables.
      </p>
      <p>
        All compliant applications MUST create annotated tables based on the algorithm defined here. All compliant applications MUST generate errors if a metadata document does not conform to this specification, such as:
      </p>
      <ul>
        <li>not being compliant with JSON syntax</li>
        <li>using any JSON outside of the restrictions defined in <a href="#json-ld-dialect" class="sectionRef"></a></li>
        <li>not specifying a property that it is required to specify</li>
        <li>including properties (aside from <a title="common property">common properties</a>) which are not defined in this specification</li>
        <li>having invalid values for a given property</li>
      </ul>
      <p>
        Metadata documents contain descriptions of groups of tables, tables, columns, rows, cells and regions which are used to create annotations on a tabular data model. There are two types of description objects:
      </p>
      <ul>
        <li>descriptions that appear within a schema, and that may apply across multiple tabular data files &mdash; these are used to describe the general structure of a tabular data file</li>
        <li>descriptions of particular groups of tables, tables, columns, rows, cells and regions within a single tabular data file &mdash; these are used for notes or flags on particular data</li>
      </ul>
      <p>
        The description objects themselves contain a number of properties. These are:
      </p>
      <ul>
        <li>properties that are used to identify the table or column that the annotations should appear on; these match up to core annotations on those objects in the annotated tabular data model defined in [[!tabular-data-model]] and do not create new annotations</li>
        <li>properties that are used to create annotations that appear directly on the group of tables, table, column, row or cell whose description they appear on, such as the <code>name</code> of a column or the <code>dc:provenance</code> of a table</li>
        <li>properties that are inherited, for example by being specified on the description of a group of tables and being inherited by each table in that group, or being specified for a table or column but being used to create or affect the values of annotations on each of the cells that appear in that table or column</li>
      </ul>
      <p>
        For example, in the <a>column description</a>
      </p>
      <pre class="example highlight">
{
  "name": "inventory_date",
  "title": "Inventory Date",
  "dc:description": "The date of the operation that was performed.",
  "datatype": {
    "base": "date",
    "format": "M/d/yyyy"
  }
}
      </pre>
      <p>
        the properties <code>name</code>, <code>title</code> and <code>dc:description</code> are used to create the <a href="http://w3c.github.io/csvw/syntax/#dfn-column-name" class="externalDFN">name</a>, <a href="http://w3c.github.io/csvw/syntax/#dfn-column-titles" class="externalDFN">titles</a> and <code>dc:description</code> annotations on the <a href="http://w3c.github.io/csvw/syntax/#dfn-column" class="externalDFN">column</a> in the data model. The <code>datatype</code> and <code>format</code> properties are <a title="inherited property">inherited properties</a> that affect the <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-value" class="externalDFN">value</a> of each <a href="http://w3c.github.io/csvw/syntax/#dfn-cell" class="externalDFN">cell</a> in that column.
      </p>
      <p>The <dfn>property value</dfn> of an annotation is that defined in the metadata, unless otherwise noted.</p>
    </section>
    <section>
      <h2>Metadata Format</h2>
      <p>
        This section defines a set of properties and permitted values for annotating tabular data, and how these properties should be interpreted by applications.
      </p>
      <p>
        A metadata document is a JSON document which holds an object at the top level. This object is a <a>description object</a> of either a table group or a single table. A <dfn>description object</dfn> is a JSON object that describes a component of the tabular data model (a table group, a table, a column, a row or a cell) and has one or more properties are mapped into properties on that component. 
      </p>
      <section>
        <h3>Property Syntax</h3>
        <p>
          There are different types of properties on description objects:
        </p>
        <ul>
          <li><a href="#array-properties" class="sectionRef"></a></li>
          <li><a href="#link-properties" class="sectionRef"></a></li>
          <li><a href="#uri-template-properties" class="sectionRef"></a></li>
          <li><a href="#column-reference-properties" class="sectionRef"></a></li>
          <li><a href="#object-properties" class="sectionRef"></a></li>
          <li><a href="#natural-language-properties" class="sectionRef"></a></li>
          <li><a href="#atomic-properties" class="sectionRef"></a></li>
        </ul>
        <section>
          <h4>Array Properties</h4>
          <p>
            <dfn title="array property">Array properties</dfn> hold an array of one or more objects, which are usually <a title="description object">description objects</a>.
          </p>
          <p>
            For example, the <code>resources</code> property is an array property. A <a>table group description</a> might contain:
          </p>
          <pre>
"resources": [{
  "url": "https://example.org/countries.csv",
  "tableSchema": "https://example.org/countries.json"
}, {
  "url": "https://example.org/country_slice.csv",
  "tableSchema": "https://example.org/country_slice.json"
}]
          </pre>
          <p>
            in which case the <code>resources</code> property has a value that is an array of two <a>table description</a> objects.
          </p>
        </section>
        <section>
          <h4>Link Properties</h4>
          <p>
            <dfn title="link property">Link properties</dfn> hold a single reference to another resource by URL. Their value is a <strong>string</strong> &mdash; resolved as a URL against the <a>base URL</a>.
          </p>
          <p>
            For example, the <code>url</code> property is a link property. A <a>table description</a> might contain:
          </p>
          <pre class="example highlight">
"url": "example-2014-01-03.csv"
          </pre>
          <p>
            in which case the <code>url</code> property on the table would have a single value, a link to <code>example-2014-01-03.csv</code>, resolved against the <a>base URL</a> of the metadata document in which this was located.
          </p>
        </section>
        <section>
          <h4>URI Template Properties</h4>
          <p>
            A <dfn>URI template property</dfn> contains a [[!URI-TEMPLATE]] which can be used to generate a URI. These URI templates are expanded in the context of each row by combining the template with a set of variables with values. The variables that are set are:
          </p>
          <dl>
            <dt>column names</dt>
            <dd>a variable is set for each column within the schema; the name of the variable is the <a href="#column-name"><code>name</code></a> of the column and the value is derived from the <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-value" class="externalDFN">value</a> of the cell in that column in the row that is currently being processed, namely one of:
              <ul>
                <li><code>null</code></li>
                <li>the <a href="http://www.w3.org/TR/xmlschema11-2/#dt-canonical-representation" class="externalDFN">canonical representation</a> of the value of the cell, as defined in [[!xmlschema11-2]], if it has a single value</li>
                <li>a list of <a href="http://www.w3.org/TR/xmlschema11-2/#dt-canonical-representation" class="externalDFN">canonical representations</a> of the values of the cell, if it has a sequence value</li>
              </ul>
            </dd>
            <dt><code>_column</code></dt>
            <dd><code>_column</code> is set to the <a href="http://w3c.github.io/csvw/syntax/#dfn-column-number" class="externalDFN">column number</a> of the <a href="http://w3c.github.io/csvw/syntax/#dfn-column" class="externalDFN">column</a> from the <a href="http://w3c.github.io/csvw/syntax/#dfn-annotated-table" class="externalDFN">annotated table</a> that is currently being processed</dd>
            <dt><code>_sourceColumn</code></dt>
            <dd><code>_sourceColumn</code> is set to the <a href="http://w3c.github.io/csvw/syntax/#dfn-column-source-number" class="externalDFN">source number</a> of the column that is currently being processed; this usually varies from <code>_column</code> by <a href="http://w3c.github.io/csvw/syntax/#dfn-skip-columns" class="externalDFN">skip columns</a> and <a href="http://w3c.github.io/csvw/syntax/#dfn-header-columns" class="externalDFN">header columns</a></dd>
            <dt><code>_row</code></dt>
            <dd><code>_row</code> is set to the <a href="http://w3c.github.io/csvw/syntax/#dfn-row-number" class="externalDFN">row number</a> of the <a href="http://w3c.github.io/csvw/syntax/#dfn-row" class="externalDFN">row</a> from the <a href="http://w3c.github.io/csvw/syntax/#dfn-annotated-table" class="externalDFN">annotated table</a> that is currently being processed</dd>
            <dt><code>_sourceRow</code></dt>
            <dd><code>_sourceRow</code> is set to the <a href="http://w3c.github.io/csvw/syntax/#dfn-row-source-number" class="externalDFN">source number</a> of the row that is currently being processed; this usually varies from <code>_row</code> by <a href="http://w3c.github.io/csvw/syntax/#dfn-skip-rows" class="externalDFN">skip rows</a> and <a href="http://w3c.github.io/csvw/syntax/#dfn-header-rows" class="externalDFN">header rows</a></dd>
            <dt><code>_name</code></dt>
            <dd><code>_name</code> is set to the URI decoded <a>property value</a> of the <code>name</code> property on the cell column that is currently being processed. <span class="note">URI decoding is necessary as <code>name</code> may have been encoded if taken from <code>title</code>; this prevents double URI encoding.</span>
            </dd>
          </dl>
          <p>
            The <a>property value</a> of a <a>URI template property</a> is only available when processing individual cells in a table, usually while converting tables as defined in [[!tabular-data-model]]. The value is the result of:
          </p>
          <ol class="algorithm">
            <li>applying the template against the cell in that column in the row that is currently being processed</li>
            <li>expanding any prefixes as if the value were the name of a <a>common property</a>, as described in <a href="#common-properties" class="sectionRef"></a></li>
            <li>resolving the resulting URL against the base URL of the <a href="http://w3c.github.io/csvw/syntax/#dfn-table-url" class="externalDFN">table url</a> if not null</li>
          </ol>
          <p>
            For example, the <a href="#cell-aboutUrl"><code>aboutUrl</code></a> property holds a URI template that is used to generate a URL identifier for each row, which might look like:
          </p>
          <pre class="example highlight" title="expanded aboutUrl using _row">
"aboutUrl": "http://example.org/example.csv#row.{_row}"
          </pre>
          <p>
            The identifiers that are generated for the rows would then look like <code>http://example.org/example.csv#row.1</code>, <code>http://example.org/example.csv#row.2</code> and so on.
          </p>
          <p>
            Alternatively, with the CSV and metadata in the <a href="#introduction" class="sectionRef"></a>, the <a href="#cell-aboutUrl"><code>aboutUrl</code></a> might look like:
          </p>
          <pre class="example highlight" title="definition of aboutUrl using column titles">
"aboutUrl": "http://example.org/tree/{on_street}/{GID}"
          </pre>
          <p>
            This would generate URIs such as <code>http://example.org/tree/ADDISON%20AV/1</code> and <code>http://example.org/tree/EMERSON%20ST/2</code>.
          </p>
          <p>
            If the value of the <code>on_street</code> or <code>GID</code> column were <code>null</code>, the URL would still be generated with the null value generating an empty string in the URL. For example if <code>on_street</code> were <code>null</code> and <code>GID</code> were <code>3</code>, the generated URL would be <code>http://example.org/tree//3</code>.
          </p>
          <p>
            Once the URI has been generated, it is resolved against the location of the resource (eg the CSV file) to create an absolute URI. For example, given a <a href="#cell-aboutUrl"><code>aboutUrl</code></a> within a schema such as:
          </p>
          <pre class="example highlight" title="definition of aboutUrl as a relative URL">
"aboutUrl": "#row.{_row}"
          </pre>
          <p>
            and given a CSV file at <code>http://example.com/temp.csv</code>, the URL for the first row will be <code>http://example.com/temp.csv#row.1</code>.
          </p>
          <p>
            The <code>propertyUrl</code> property has the default value of <code>"{#_name}</code>", meaning that it resolves as a fragment identifier relative to the URL of the source of the table. For example, if no <code>propertyUrl</code> is specified, accessing it from a column with the column name <em>GID</em> would look like:
          </p>
          <pre class="example highlight" title="expanded default for propertyUrl">
"http://example.org/example.csv#GID"
          </pre>
          <p>
            A value defined within the data is also subject to expansion. For example, consider the following table:
          </p>
          <pre class="example" title="table with compact URLs and micro syntax">
project_name,project_type,keywords
CSVW,foaf:Project,table;data;conversion
          </pre>
          <p>
            The <code>project_type</code> column might have a <code>valueUrl</code> specified as <code>"{project_type}"</code>. In the first row the cell value is <code>"foaf:Project"</code>. The <code>foaf</code> prefix is understood, as described in <a href="#common-properties" class="sectionRef"></a> to expand to <code>http://xmlns.com/foaf/0.1/Project</code>.
          </p>
          <p>
            Similarly, the <code>keywords</code> column might have a <code>valueUrl</code> specified as <code>"https://duckduckgo.com/?q={keywords}"</code>. If the column also specifies <code>"separator": ";"</code>, then the cell value of the <code>keywords</code> column would be an array of the three values <code>table</code>, <code>data</code> and <code>conversion</code>. This is set as the value of the <em>keywords</em> variable within the URI template, which means the result would be <code>https://duckduckgo.com/?q=table,data,conversion</code>.
          </p>
          <p>
            If the value in the <code>keywords</code> column were an empty sequence (created from an empty cell in the original data), the reference to that column would be expanded to an empty string, generating <code>https://duckduckgo.com/?q=</code>.
          </p>
          <p>
            When a cell's <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-value" class="externalDFN">value</a> is not a string, the canonical representation of that value is used within the expanded URL. For example, the data may include dates such as those in:
          </p>
          <pre class="example highlight" title="CSV containing dates">
GID,On Street,Species,Trim Cycle,Inventory Date
1,ADDISON AV,Celtis australis,Large Tree Routine Prune,10/18/2010
2,EMERSON ST,Liquidambar styraciflua,Large Tree Routine Prune,6/2/2010
3,EMERSON ST,Liquidambar styraciflua,Large Tree Routine Prune,6/2/2010
          </pre>
          <p>
            The <code>Inventory Date</code> column description would indicate that these were dates with the format <code>M/d/yyyy</code>:
          </p>
          <pre class="example highlight">
{
  "name": "inventory_date",
  "title": "Inventory Date",
  "datatype": {
    "base": "date",
    "format": "M/d/yyyy"
  }
}
          </pre>
          <p>
            The string value of the <code>inventory_date</code> column in the first row is parsed to create the date 18th October 2010. When the <code>inventory_date</code> column is referenced within a URI template such as <code>http://example.org/event/{inventory_date}</code>, the <a href="http://www.w3.org/TR/xmlschema11-2/#dt-canonical-representation" class="externalDFN">canonical representation</a> of that date is used within the URL, giving the result <code>http://example.org/event/2010-10-18</code>.
          </p>
        </section>
        <section>
          <h4>Column Reference Properties</h4>
          <p>
            <dfn title="column reference property">Column reference properties</dfn> hold one or more references to other <a>column description</a> objects. The referenced description object must have an <code>name</code> property. Column reference properties can then reference column description objects through values that are:
          </p>
          <ul>
            <li><strong>strings</strong> &mdash; which MUST match the <code>name</code> on a <a>column description</a> object within the metadata document</li>
            <li><strong>arrays</strong> &mdash; lists of strings as above</li>
          </ul>
          <p>
            For example, the <code>primaryKey</code> property is an column reference property on the schema. It has to hold references to columns defined elsewhere in the schema, and the descriptions of those columns must have <code>name</code> properties. It can hold a single reference, like this:
          </p>
          <pre class="example highlight">
"tableSchema": {
  "columns": [{
    "name": "GID"
  }, ... ],
  "primaryKey": "GID"
}
          </pre>
          <p>
            or it can contain an array of references, like this:
          </p>
          <pre class="example highlight">
"tableSchema": {
  "columns": [{
    "name": "givenName"
  }, {
    "name": "familyName"
  }, ... ],
  "primaryKey": [ "givenName", "familyName" ]
}
          </pre>
        </section>
        <section>
          <h4>Object Properties</h4>
          <p>
            <dfn title="object property">Object properties</dfn> hold a single object or reference to an object by URL. Their values may be:
          </p>
          <ul>
            <li><strong>strings</strong> &mdash; resolved as URLs against the <a>base URL</a></li>
            <li><strong>objects</strong> &mdash; interpreted as structured objects</li>
          </ul>
          <p>
            Object properties are often used when the values can be or should be values within controlled vocabularies, or structured information which may be held elsewhere. For example, the <code>dialect</code> of a table is an object property. It could be provided as a URL that indicates a commonly used dialect, like this:
          </p>
          <pre class="example highlight">
"dialect": "http://example.org/tab-separated-values"
          </pre>
          <p>
            or a structured object, like this:
          </p>
          <pre class="example highlight">
"dialect": {
  "delimiter": "\t",
  "encoding": "utf-8"
}
          </pre>
        </section>
        <section>
          <h4>Natural Language Properties</h4>
          <p>
            <dfn title="natural language property">Natural language properties</dfn> hold natural language strings. Their values may be:
          </p>
          <ul>
            <li><strong>strings</strong> &mdash; interpreted as natural language strings in the <a>default language</a></li>
            <li><strong>arrays</strong> &mdash; interpreted as alternative natural language strings in the <a>default language</a></li>
            <li><strong>objects</strong> whose properties MUST be language codes as defined by [[!BCP47]] and whose values are either strings or arrays, providing natural language strings in that language</li>
          </ul>
          <p>
            Natural language properties are used for things like descriptions and titles. For example, the <code>title</code> property provides a natural language label for a column. If it's a plain string like this:
          </p>
          <pre class="example highlight">
"title": "Project title"
          </pre>
          <p>
            then that string is assumed to be in the language provided through the <code>@language</code> property of the <code>@context</code> (or have no assumed language, if there is no such property). Multiple alternative values can be given in an array:
          </p>
          <pre class="example highlight">
"title": [
  "Project title",
  "Project"
]
          </pre>
          <p>
            It's also possible to provide multiple values in different languages, using an object structure. For example:
          </p>
          <pre class="example highlight">
"title": {
  "en": "Project title",
  "fr": "Titre du projet"
}
          </pre>
          <p>
            and within such an object, the values of the properties can themselves be arrays:
          </p>
          <pre class="example highlight">
"title": {
  "en": [ "Project title", "Project" ],
  "fr": "Titre du projet"
}
          </pre>
          <p>
           The <a>property value</a> of a <a>natural language property</a> is an object whose properties are language codes and where the values of those properties are an array of strings (see <cite><a href="http://www.w3.org/TR/json-ld/#language-maps">Language Maps</a></cite> in [[!JSON-LD]]).
          </p>
          <p class="note">
            When extracting a <a>property value</a> metadata will have already been <a>merged</a>, a <a>natural language property</a> will already have this form.
          </p>
        </section>
        <section>
          <h4>Atomic Properties</h4>
          <p>
            <dfn title="atomic property">Atomic properties</dfn> hold <dfn title="atomic value">atomic values</dfn>. Their values may be:
          </p>
          <ul>
            <li><strong>numbers</strong> &mdash; interpreted as integers or doubles</li>
            <li><strong>booleans</strong> &mdash; interpreted as booleans (<code>true</code> or <code>false</code>)</li>
            <li><strong>strings</strong> &mdash; interpreted as defined by the property</li>
            <li><strong>objects</strong> &mdash; interpreted as defined by the property</li>
            <li><strong>arrays</strong> &mdash; lists of numbers, booleans, strings, or objects</li>
          </ul>
          <p class="note">
            JSON does not have date or time types. Where a property takes a date as a value, this MUST be a string in the format <code>YYYY-MM-DD</code>.
          </p>
        </section>
      </section>
      <section>
        <h3>Top-Level Properties</h3>
        <p>
          The top-level object (whether it is a <a>table group description</a> or a <a>table description</a>) MUST have a <code id="context">@context</code> property, an <a>array property</a>, as defined in <cite><a href="http://www.w3.org/TR/json-ld/#context-definitions">Section 8.7</a></cite> of [[!JSON-LD]]. The <code>@context</code> MUST contain one of the following:</p>
        <ul>
          <li>A string value of <code>http://www.w3.org/ns/csvw</code>, or</li>
          <li>An array composed of a string and an object, where the string is <code>http://www.w3.org/ns/csvw</code> and the object representing a local context definition, which is restricted to contain either or both of the following members.</li>
        </ul>
        <dl>
          <dt id="context-language"><code>@language</code></dt>
          <dd>
            <p>
              indicates the default language for the values of properties in the metadata document; if present, its value MUST be a language code [[!BCP47]] which is the <dfn>default language</dfn> for the values of other properties in the metadata document
            </p>
            <p class="note">
              Note that the <code>@language</code> property of the <code>@context</code> object, which gives the default language used within the metadata file, is distinct from the <code>lang</code> property on a <a>description object</a>, which gives the language used in the data within a group of tables, table or column.
            </p>
          </dd>
          <dt id="context-base"><code>@base</code></dt>
          <dd>
            <p>
              indicates the base URL against which other URLs within the description are resolved; if present, its value MUST be a URL which is resolved against the location of the metadata document to provide the <dfn>base URL</dfn> for other URLs in the metadata document; if unspecified, the base URL used for interpreting relative URLs within the metadata document is the location of the metadata document itself
            </p>
            <p class="note">
              Note that the <code>@base</code> property of the <code>@context</code> object provides the base URL used for URLs within the metadata document, not the URLs that appear as data within the group of tables or table it describes.
            </p>
          </dd>
        </dl>
      </section>
      <section>
        <h3>Common Properties</h3>
        <p>
          Descriptions of groups of tables, tables, schemas, columns, rows and cells MAY contain any <dfn title="common property">properties</dfn> whose names are either absolute URLs or <a href="http://www.w3.org/TR/json-ld/#dfn-compact-iri" class="externalDFN">prefixed names</a>. For example, a table description may contain <code>dc:description</code>, <code>dcat:keyword</code> or <code>schema:copyrightHolder</code> properties to provide a description, keywords or the name of the copyright holder, as defined in <a href="http://dublincore.org/documents/2010/10/11/dcmi-terms/#elements-description">Dublin Core Terms</a>, <a href="http://www.w3.org/TR/vocab-dcat/#Property:dataset_keyword">DCAT</a> or <a href="http://schema.org/copyrightHolder">schema.org</a>.
        </p>
        <section>
          <h4>Names of Common Properties</h4>
          <p>
            The names of common properties are <a href="http://www.w3.org/TR/json-ld/#dfn-compact-iri" class="externalDFN">prefixed names</a>, in the syntax <code><var>prefix</var>:<var>name</var></code>.
          </p>
          <p>
            <a href="http://www.w3.org/TR/json-ld/#dfn-compact-iri" class="externalDFN">Prefixed names</a> can be <dfn title="expansion">expanded</dfn> to provide a URI, by replacing the prefix and following colon with the URI with the URI that the prefix is associated with. Expansion is intended to be entirely consistent with <cite><a href="http://www.w3.org/TR/json-ld-api/#iri-expansion">Section 6.3 IRI Expansion</a></cite> in [[!JSON-LD-API]] and implementations MAY use a JSON-LD processor for performing prefixed name and IRI expansion.
          </p>
          <p>
            The prefixes that are recognised are those defined for [[rdfa-core]] within the <a href="http://www.w3.org/2011/rdfa-context/rdfa-1.1">RDFa 1.1 Initial Context</a> and these MUST NOT be overridden. Properties from other vocabularies MUST be named using absolute URLs.
          </p>
          <p class="note">
            Forbidding the declaration of new prefixes ensures consistent processing between JSON-LD-aware and non-JSON-LD-aware processors.
          </p>
          <p>
            Implementations SHOULD treat the <a href="http://www.w3.org/TR/json-ld/#dfn-compact-iri" class="externalDFN">prefixed names</a> for common properties and the URLs that they expand into in the same way. For example, if an implementation recognises and displays the value of the <code>dc:description</code> property, it should also recognise and display the value of the <code>http://purl.org/dc/terms/description</code> property in the same way.
          </p>
        </section>
        <section>
          <h4>Values of Common Properties</h4>
          <p>
            Common properties can take any JSON value, so long as it adheres to the following restrictions, which are designed to ensure compatibility between JSON-LD-aware and non-JSON-LD-aware processors:
          </p>
          <ul>
            <li>
              <p>
                If a <code>@value</code> property is used on an object, that object MUST NOT have any other properties aside from either <code>@type</code> or <code>@language</code>, and MUST NOT have both <code>@type</code> and <code>@language</code> as properties. The value of the <code>@value</code> property MUST be a string, number or boolean value.
              </p>
              <p>
                If <code>@type</code> is used, its value MUST be one of:
              </p>
              <ul>
                <li>a built-in datatype, as defined in <a href="#built-in-datatypes" class="sectionRef"></a></li>
                <li>a <a href="http://www.w3.org/TR/json-ld/#dfn-compact-iri" class="externalDFN">prefixed name</a> using any of the pre-defined prefixes as described in <a href="#names-of-common-properties" class="sectionRef"></a></li>
                <li>a string, which will be interpreted as an absolute URL</li>
              </ul>
              <p>
                If a <code>@language</code> property is used, it MUST have a string value that adheres to the syntax defined in [[!BCP47]], or be <code>null</code>.
              </p>
            </li>
            <li>
              <p>
                If a <code>@type</code> property is used on an object without a <code>@value</code> property, its value MUST be one of:
              </p>
              <ul>
                <li>one of the legitimate values for <code>@type</code> as defined for any of the description objects in this specification</li>
                <li>a <a href="http://www.w3.org/TR/json-ld/#dfn-compact-iri" class="externalDFN">prefixed name</a> using any of the pre-defined prefixes as described in <a href="#names-of-common-properties" class="sectionRef"></a></li>
                <li>a string, which will be interpreted as an absolute URL</li>
              </ul>
              <p>
                A <code>@type</code> property can also have a value that is an array of such values.
              </p>
            </li>
            <li>
              <p>
                The values of <code>@id</code> properties are assumed to be URLs and will have any prefix <a title="expansion">expanded</a> and the result resolved against the <a>base URL</a> during <a>normalization</a>. Therefore, if a <code>@id</code> property is used on an object, it MUST have a value that is a string and that string MUST NOT start with <code>_:</code>.
              </p>
            </li>
            <li>
              <p>
                A <code>@language</code> property MUST NOT be used on an object unless it also has a <code>@value</code> property.
              </p>
            </li>
            <li>
              Aside from <code>@value</code>, <code>@type</code>, <code>@language</code> and <code>@id</code>, the properties used on an object MUST NOT start with <code>@</code>.
            </li>
          </ul>
          <p>
            These restrictions are also described in <a href="#json-ld-dialect" class="sectionRef"></a>, from the perspective of a processor that otherwise supports JSON-LD.
          </p>
        </section>
      </section>
      <section>
        <h3>Table Groups</h3>
        <p>
          A <dfn>table group description</dfn> is a JSON object that describes a <a href="http://w3c.github.io/csvw/syntax/#dfn-group-of-tables" class="externalDFN">group of tables</a>.
        </p>
        <section>
          <h4>Required Properties</h4>
          <dl>
            <dt id="table-group-resources"><code>resources</code></dt>
            <dd>
              <p>An <a>array property</a> of <a title="table description">table descriptions</a> for the tables in the group, namely those listed in the <a href="http://w3c.github.io/csvw/syntax/#dfn-table-group-resources" class="externalDFN">resources</a> annotation on the <a href="http://w3c.github.io/csvw/syntax/#dfn-group-of-tables" class="externalDFN">group of tables</a> being described.</p>
              <p>When an array of table descriptions <code>B</code> is <a>merged</a> into an original array of table descriptions <code>A</code>, each table description within <code>B</code> is combined into the original array <code>A</code> by:</p>
              <ul>
                <li>if there is a table description with the same <code>url</code> in <code>A</code>, the table description from <code>B</code> is <a>merged</a> into the matching table description in <code>A</code></li>
                <li>otherwise, the table description from <code>B</code> is appended to the array of table descriptions <code>A</code></li>
              </ul>
            </dd>
          </dl>
        </section>
        <section>
          <h4>Optional Properties</h4>
          <p>
            The description of a group of tables MAY also contain:
          </p>
          <dl>
            <dt id="table-group-schema"><code>tableSchema</code></dt>
            <dd>
              <p>An <a>object property</a> that provides a single <a>schema description</a> as described in <a href="#schemas" class="sectionRef"></a>, used as the default for all the tables in the group. This may be provided as an embedded object within the JSON metadata or as a URL reference to a separate JSON schema document.</p>
            </dd>
            <dt id="table-group-direction"><code>tableDirection</code></dt>
            <dd>
              <p>
                An <a>atomic property</a> that MUST have a single string value that is one of <code>"rtl"</code>, <code>"ltr"</code> or <code>"default"</code>. Indicates whether the tables in the group should be displayed with the first column on the right, on the left, or based on the first character in the table that has a specific direction. The value of this property becomes the value of the <a href="http://w3c.github.io/csvw/syntax/#dfn-table-direction" class="externalDFN">direction</a> annotation for all the tables in the table group.
              </p>
            </dd>
            <dt id="table-group-dialect"><code>dialect</code></dt>
            <dd>
              <p>An <a>object property</a> that provides a single <a>dialect description</a>. If provided, <code>dialect</code> provides hints to processors about how to parse the referenced files for to create tabular data models for the tables in the group. This may be provided as an embedded object or as a URL reference. See <a href="#dialect-descriptions" class="sectionRef"></a> for more details.</p>
            </dd>
            <dt id="table-group-transformations"><code>transformations</code></dt>
            <dd>
              <p>An <a>array property</a> of <a title="transformation definition">transformation definitions</a> that provide mechanisms to transform the tabular data into other formats. The value of this property becomes the value of the <a href="http://w3c.github.io/csvw/syntax/#dfn-table-transformations" class="externalDFN">transformations</a> annotation for all the tables in the table group.</p>
              <p>When an array of transformation definitions <code>B</code> is <a>merged</a> into an original array of transformation definitions <code>A</code>, each transformation definition within <code>B</code> is combined into the original array <code>A</code> by:</p>
              <ul>
                <li>if there is a transformation definition with the same <code>url</code> in <code>A</code>, the transformation definition from <code>B</code> is <a>merged</a> into the matching transformation definition in A</li>
                <li>otherwise, the transformation definition from <code>B</code> is appended to the array of transformation definitions <code>A</code></li>
              </ul>
            </dd>
            <dt id="table-group-ld-id"><code>@id</code></dt>
            <dd>
              If included, <code>@id</code> identifies the <a href="http://w3c.github.io/csvw/syntax/#dfn-group-of-tables" class="externalDFN">group of tables</a>, as defined by [[!tabular-data-model]], described by this <a>table group description</a>. The value of this property becomes the value of the <a href="http://w3c.github.io/csvw/syntax/#dfn-table-group-id" class="externalDFN">id</a> annotation for the table group. Publishers MAY include this to provide additional information to JSON-LD based toolchains.
            </dd>
            <dt id="table-group-ld-type"><code>@type</code></dt>
            <dd>
              <p>If included, <code>@type</code> MUST be set to <code>"TableGroup"</code>. Publishers MAY include this to provide additional information to JSON-LD based toolchains.</p>
            </dd>
          </dl>
          <p>
            The description MAY contain any <a title="common property">common properties</a> to provide extra metadata about the set of tables as a whole.
          </p>
          <p>
            The description MAY contain <a title="inherited property">inherited properties</a> to describe cells within the tables.
          </p>
        </section>
      </section>
      <section>
        <h3>Tables</h3>
        <p>
          A <dfn>table description</dfn> is a JSON object that describes a table within a CSV file.
        </p>
        <section>
          <h4>Required Properties</h4>
          <dl>
            <dt id="table-url"><code>url</code></dt>
            <dd>
              <p>
                This <a>link property</a> gives the single URL of the CSV file that the table is held in, relative to the location of the metadata document. The value of this property is the value of the <a href="http://w3c.github.io/csvw/syntax/#dfn-table-url" class="externalDFN">url</a> annotation for the table this table description describes.
              </p>
            </dd>
          </dl>
        </section>
        <section>
          <h4>Optional Properties</h4>
          <p>
            The description of a table MAY also contain:
          </p>
          <dl>
            <dt id="table-schema"><code>tableSchema</code></dt>
            <dd>
              <p>An <a>object property</a> that provides a single <a>schema description</a> as described in <a href="#schemas" class="sectionRef"></a>. This may be provided as an embedded object within the JSON metadata or as a URL reference to a separate JSON schema document. If a table description is within a <a>table group description</a>, the <code>tableSchema</code> from that table group acts as the default for this property.</p>
              <p>The <a>property value</a> of a <code>tableSchema</code>is that defined in the <a>table description</a>, if any, or that defined in the <a>table group description</a>, if any, or <code>null</code>.</p>
            </dd>
            <dt id="table-notes"><code>notes</code></dt>
            <dd>
              <p>
                An <a>array property</a> that provides an array of objects representing arbitrary annotations on the annotated tabular data model.  The value of this property becomes the value of the <a href="http://w3c.github.io/csvw/syntax/#dfn-table-notes" class="externalDFN">notes</a> annotation for the table. The properties on these objects are interpreted equivalently to <a title="common property">common properties</a> as described in <a href="#common-properties" class="sectionRef"></a>. When an array of note objects <code>B</code> is <a>merged</a> into an original array of note objects <code>A</code>, each note object from <code>B</code> is appended into the array <code>A</code>.
              </p>
              <p class="note">
                The <a href="http://www.w3.org/annotation/">Web Annotation Working Group</a> is developing a vocabulary for expressing annotations. In future versions of this specification, we anticipate referencing that vocabulary.
              </p>
            </dd>
            <dt id="table-title"><code>title</code></dt>
            <dd>
              <p>A <a>natural language property</a> that describes the title of the table.</p>
            </dd>
            <dt id="tableDirection"><code>tableDirection</code></dt>
            <dd><p>As defined for <a href="#table-group-direction">table groups</a>. The value of this property becomes the value of the <a href="http://w3c.github.io/csvw/syntax/#dfn-table-direction" class="externalDFN">direction</a> annotation for this table.</p></dd>
            <dt id="table-transformations"><code>transformations</code></dt>
            <dd><p>As defined for <a href="#table-group-templates">table groups</a>. The value of this property becomes the value of the <a href="http://w3c.github.io/csvw/syntax/#dfn-table-transformations" class="externalDFN">transformations</a> annotation for this table.</p></dd>
            <dt id="table-dialect"><code>dialect</code></dt>
            <dd><p>As defined for <a href="#table-group-dialect">table groups</a>.</p></dd>
            <dt id="table-suppressOutput"><code>suppressOutput</code></dt>
            <dd>
              <p>A boolean <a>atomic property</a>. If <code>true</code>, suppresses any output that would be generated when converting this table. The value of this property becomes the value of the <a href="http://w3c.github.io/csvw/syntax/#dfn-table-suppress-output" class="externalDFN">suppress output</a> annotation for this table.</p>
            </dd>
            <dt id="table-ld-id"><code>@id</code></dt>
            <dd>
              <p>If included, <code>@id</code> identifies the <a href="http://w3c.github.io/csvw/syntax/#dfn-table" class="externalDFN">table</a>, as defined in [[!tabular-data-model]], described by this <a>table description</a>. The value of this property becomes the value of the <a href="http://w3c.github.io/csvw/syntax/#dfn-table-id" class="externalDFN">id</a> annotation for this table. Publishers MAY include this to provide additional information to JSON-LD based toolchains.</p>
            </dd>
            <dt id="table-ld-type"><code>@type</code></dt>
            <dd>
              <p>If included, <code>@type</code> MUST be set to <code>"Table"</code>. Publishers MAY include this to provide additional information to JSON-LD based toolchains.</p>
            </dd>
          </dl>
          <p>
            The description MAY contain any <a title="common property">common properties</a> to provide extra metadata about the table as a whole.
          </p>
          <p>
            The description MAY contain <a title="inherited property">inherited properties</a> to describe cells within the table.
          </p>
        </section>
      </section>
      <section>
        <h3>Dialect Descriptions</h3>
        <p>
          Much of the tabular data that is published on the web is messy, and CSV parsers frequently need to be configured in order to correctly read in CSV. A <dfn>dialect description</dfn> provides hints to parsers about how to parse the file linked to from the <code>url</code> property. It can have any of the following properties, which relate to the flags described in <a href="http://w3c.github.io/csvw/syntax/#parsing">Section 5 Parsing Tabular Data</a> within [[!tabular-data-model]]:
        </p>
        <dl>
          <dt id="dialect-encoding"><code>encoding</code></dt>
          <dd>
            <p>An <a>atomic property</a> that sets the <a href="http://w3c.github.io/csvw/syntax/#dfn-encoding" class="externalDFN">encoding</a> flag to the single provided string value, which MUST be a defined [[!encoding]].</p>
          </dd>
          <dt id="dialect-lineTerminator"><code>lineTerminator</code></dt>
          <dd>
            <p>An <a>atomic property</a> that sets the <a href="http://w3c.github.io/csvw/syntax/#dfn-line-terminator" class="externalDFN">line terminator</a> flag to the single provided string value.</p>
          </dd>
          <dt id="dialect-quoteChar"><code>quoteChar</code></dt>
          <dd>
            <p>An <a>atomic property</a> that sets the <a href="http://w3c.github.io/csvw/syntax/#dfn-quote-character" class="externalDFN">quote character</a> flag to the single provided value, which MUST be a single character.</p>
          </dd>
          <dt id="dialect-doubleQuote"><code>doubleQuote</code></dt>
          <dd>
            <p>A single boolean <a>atomic property</a> that, if <code>true</code>, sets the <a href="http://w3c.github.io/csvw/syntax/#dfn-escape-character" class="externalDFN">escape character</a> flag to <code>"</code>. If <code>false</code>, to <code>\</code>.</p>
          </dd>
          <dt id="dialect-skipRows"><code>skipRows</code></dt>
          <dd>
            <p>An <a>atomic property</a> that sets the <a href="http://w3c.github.io/csvw/syntax/#dfn-skip-rows" class="externalDFN">skip rows</a> flag to the single provided numeric value, which MUST be a non-negative integer.</p>
          </dd>
          <dt id="dialect-commentPrefix"><code>commentPrefix</code></dt>
          <dd>
            <p>An <a>atomic property</a> that sets the <a href="http://w3c.github.io/csvw/syntax/#dfn-comment-prefix" class="externalDFN">comment prefix</a> flag to the single provided value, which MUST be a single character string.</p>
          </dd>
          <dt id="dialect-header"><code>header</code></dt>
          <dd>
            <p>A single boolean <a>atomic property</a> that, if <code>true</code>, sets the <a href="http://w3c.github.io/csvw/syntax/#dfn-header-row-count" class="externalDFN">header row count</a> flag to <code>1</code>, and if <code>false</code> to <code>0</code>, unless <a href="#dialect-headerRowCount"><code>headerRowCount</code></a> is provided, in which case the value provided for the <code>header</code> property is ignored.</p>
          </dd>
          <dt id="dialect-headerRowCount"><code>headerRowCount</code></dt>
          <dd>
            <p>An <a>atomic property</a> that sets the <a href="http://w3c.github.io/csvw/syntax/#dfn-header-row-count" class="externalDFN">header row count</a> flag to the single provided value, which MUST be a non-negative integer.</p>
          </dd>
          <dt id="dialect-delimiter"><code>delimiter</code></dt>
          <dd>
            <p>An <a>atomic property</a> that sets the <a href="http://w3c.github.io/csvw/syntax/#dfn-delimiter" class="externalDFN">delimiter</a> flag to the single provided value, which MUST be a single character string.</p>
          </dd>
          <dt id="dialect-skipColumns"><code>skipColumns</code></dt>
          <dd>
            <p>An <a>atomic property</a> that sets the <a href="http://w3c.github.io/csvw/syntax/#dfn-skip-columns" class="externalDFN">skip columns</a> flag to the single provided numeric value, which MUST be a non-negative integer.</p>
          </dd>
          <dt id="dialect-headerColumnCount"><code>headerColumnCount</code></dt>
          <dd>
            <p>An <a>atomic property</a> that sets the <a href="http://w3c.github.io/csvw/syntax/#dfn-header-column-count" class="externalDFN">header column count</a> flag to the single provided value, which MUST be non-negative integer.</p>
          </dd>
          <dt id="dialect-skipBlankRows"><code>skipBlankRows</code></dt>
          <dd>
            <p>An <a>atomic property</a> that sets the <a href="http://w3c.github.io/csvw/syntax/#dfn-skip-blank-rows" class="externalDFN">skip blank rows</a> flag to the single provided boolean value.</p>
          </dd>
          <dt id="dialect-skipInitialSpace"><code>skipInitialSpace</code></dt>
          <dd>
            <p>A single boolean <a>atomic property</a> that, if <code>true</code>, sets the <a href="http://w3c.github.io/csvw/syntax/#dfn-trim" class="externalDFN">trim</a> flag to <code>"start"</code>. If <code>false</code>, to <code>false</code>. If the <a href="#dialect-trim"><code>trim</code></a> property is provided, the <code>skipInitialSpace</code> property is ignored.</p>
          </dd>
          <dt id="dialect-trim"><code>trim</code></dt>
          <dd>
            <p>A single <a>atomic property</a> that, if the boolean <code>true</code>, sets the <a href="http://w3c.github.io/csvw/syntax/#dfn-trim" class="externalDFN">trim</a> flag to <code>true</code> and if the boolean <code>false</code> to <code>false</code>. If the value provided is a string, sets the <a href="http://w3c.github.io/csvw/syntax/#dfn-trim" class="externalDFN">trim</a> flag to the provided value, which MUST be one of <code>"true"</code>, <code>"false"</code>, <code>"start"</code> or <code>"end"</code>.</p>
          </dd>
          <dt id="dialect-ld-id"><code>@id</code></dt>
          <dd>
            <p>If included, <code>@id</code> identifies the dialect described by this <a>dialect description</a>. Publishers MAY include this to provide additional information to JSON-LD based toolchains.</p>
          </dd>
          <dt id="dialect-ld-type"><code>@type</code></dt>
          <dd>
            <p>If included, <code>@type</code> MUST be set to <code>"Dialect"</code>. Publishers MAY include this to provide additional information to JSON-LD based toolchains.</p>
          </dd>
        </dl>
        <p class="note">
          Dialect descriptions do not provide a mechanism for handling CSV files in which there are multiple tables within a single file (eg separated by empty lines).
        </p>
        <p>The <a>property value</a> of a <a>dialect description</a> is that defined in the <a>table description</a>, if any, or that defined in the <a>table group description</a>, if any, or the default defined for that property.</p>
        <div class="example">
          <p>
            The default dialect description for CSV files is:
          </p>
          <pre>
{
  "encoding": "utf-8",
  "lineTerminator": "\r\n",
  "quoteChar": "\"",
  "doubleQuote": true,
  "skipRows": 0,
  "commentPrefix": "#",
  "header": true,
  "headerRowCount": 1,
  "delimiter": ",",
  "skipColumns": 0,
  "headerColumnCount": 0,
  "skipBlankRows": false,
  "skipInitialSpace": false,
  "trim": false
}
          </pre>
        </div>
      </section>
      <section>
        <h3>Transformation Definitions</h3>
        <p>
          A <dfn>transformation definition</dfn> is a definition of how tabular data can be transformed into another format using a script or template. It has the following properties:
        </p>
        <section>
          <h4>Required Properties</h4>
          <p>
            Transformation definitions MUST have the following properties:
          </p>
          <dl>
            <dt id="transformation-url"><code>url</code></dt>
            <dd>
              <p>
                A <a>link property</a> giving the single URL of the file that the script or template is held in, relative to the location of the metadata document.
              </p>
            </dd>
            <dt id="transformation-targetFormat"><code>targetFormat</code></dt>
            <dd>
              <p>
                A <a>link property</a> giving the single URL for the format that will be created through the transformation. If one has been defined, this should be a URL for a media type, in the form <code>http://www.iana.org/assignments/media-types/<var>media-type</var></code> such as <code>http://www.iana.org/assignments/media-types/text/calendar</code>. Otherwise, it can be any URL that describes the target format.
              </p>
              <p class="note">
                The <code>targetFormat</code> URL is intended as an informative identifier for the target format, and applications SHOULD NOT access the URL.
              </p>
            </dd>
            <dt id="transformation-scriptFormat"><code>scriptFormat</code></dt>
            <dd>
              <p>
                A <a>link property</a> giving the single URL for the format that is used by the script or template. If one has been defined, this should be a URL for a media type, in the form <code>http://www.iana.org/assignments/media-types/<var>media-type</var></code> such as <code>http://www.iana.org/assignments/media-types/application/javascript</code>. Otherwise, it can be any URL that describes the script or template format.
              </p>
              <p class="note">
                The <code>scriptFormat</code> URL is intended as an informative identifier for the template format, and applications SHOULD NOT access the URL. The template formats that an application supports are implementation defined.
              </p>
            </dd>
          </dl>
        </section>
        <section>
          <h4>Optional Properties</h4>
          <p>
            Transformation definitions MAY have the following properties:
          </p>
          <dl>
            <dt id="transformation-title"><code>title</code></dt>
            <dd>
              <p>A <a>natural language property</a> that describes the format that will be generated from the transformation. This is useful if the target format is a generic format (such as <code>application/json</code>) and the transformation is creating a specific profile of that format.</p>
            </dd>
            <dt id="transformation-source"><code>source</code></dt>
            <dd>
              <p>
                A single string <a>atomic property</a> that provides, if specified, the format to which the tabular data should be transformed prior to the transformation using the script or template. If the value is <code>json</code>, the tabular data MUST first be transformed to JSON as defined by [[!csv2json]] using <a href="http://w3c.github.io/csvw/csv2json/#dfn-standard-mode" class="externalDFN">standard mode</a>. If the value is <code>rdf</code>, the tabular data MUST first be transformed to an RDF graph as defined by [[!csv2rdf]] using <a href="http://w3c.github.io/csvw/csv2rdf/#dfn-standard-mode" class="externalDFN">standard mode</a>. If the <code>source</code> property is missing or <code>null</code> then the source of the transformation is the annotated tabular data model. No other values are valid.
              </p>
            </dd>
            <dt id="transformation-ld-id"><code>@id</code></dt>
            <dd>
              <p>If included, <code>@id</code> identifies the transformation described by this <a>transformation definition</a>. Publishers MAY include this to provide additional information to JSON-LD based toolchains.</p>
            </dd>
            <dt id="transformation-ld-type"><code>@type</code></dt>
            <dd>
              <p>If included, <code>@type</code> MUST be set to <code>"Template"</code>. Publishers MAY include this to provide additional information to JSON-LD based toolchains.</p>
            </dd>
          </dl>
          <p>
            The transformation definition MAY contain any <a title="common property">common properties</a> to provide extra metadata about the transformation.
          </p>
        </section>
        <section class="informative">
          <h4>Example</h4>
          <p>
            The following transformation definition will enable a processor that supports it to generate an iCalendar document using a <a href="https://mustache.github.io/">Mustache template</a> based on the JSON created from the simple mapping to JSON.
          </p>
          <pre class="example">
{
  "url": "templates/ical.txt",
  "title": "iCalendar",
  "targetFormat": "http://www.iana.org/assignments/media-types/text/calendar",
  "scriptFormat": "https://mustache.github.io/",
  "source": "json"
} 
          </pre>
        </section>
      </section>
      <section>
        <h3>Schemas</h3>
        <p>
          A <dfn>tableSchema</dfn> is a definition of a tabular format that may be common to multiple tables. For example, multiple tables from different sources may have the same columns and be designed such that they can be aggregated together.
        </p>
        <p>
          A <dfn>schema description</dfn> is a JSON object that encodes the information about a <dfn>schema</dfn>, which describes the structure of a table. All the properties of a schema description are optional.
        </p>
        <dl>
          <dt id="schema-columns"><code>columns</code></dt>
          <dd>
            <p>
              An <a>array property</a> of <a title="column description">column descriptions</a> as described in <a href="#columns" class="sectionRef"></a>. These are matched to columns in tables that use the schema by position: the first column description in the array applies to the first column in the table, the second to the second and so on.
            </p>
            <p>
              The <a href="#column-name"><code>name</code></a> properties of the column descriptions MUST be unique within a given table description.
            </p>
            <p>
              When an array of column descriptions <code>B</code> is <a>merged</a> into an original array of column descriptions <code>A</code>, each column description within <code>B</code> is combined into the original array <code>A</code>, based on the index of each column description, as follows:
            </p>
            <ol class="algorithm">
              <li>if the column descriptions at the same index within <code>A</code> and <code>B</code> have the same <a href="#column-name"><code>name</code></a>, the column description from <code>B</code> is <a>merged</a> into the matching column description in A</li>
              <li>otherwise, if the column descriptions at the same index within <code>A</code> and <code>B</code> have matching <a href="#column-title"><code>title</code></a>s (both titles are the same and either they both have the same language or one of them has an undefined language (<code>und</code>)), the column description from <code>B</code> is <a>merged</a> into the matching column description in <code>A</code></li>
              <li>otherwise, if there are column descriptions at the same index within <code>A</code> and <code>B</code>, <a>validators</a> and <a>converters</a> MUST generate an error</li>
              <li>otherwise, if at a given index there is no column description within A, but there is a column description within <code>B</code>, then:
                <ol class="algorithm">
                  <li>if the <a href="#column-virtual"><code>virtual</code></a> property of the column description in <code>B</code> is <code>true</code>, then the column description is appended to <code>A</code></li>
                  <li>otherwise, <a>validators</a> and <a>converters</a> MUST generate an error</li>
                </ol>
              </li>
              <li>otherwise, if at a given index there is no column description within B, but there is a column description within <code>A</code>, then:
                <ol class="algorithm">
                  <li>if the <a href="#column-virtual"><code>virtual</code></a> property of the column description in <code>A</code> is <code>true</code>, then the column description is retained</li>
                  <li>otherwise, <a>validators</a> and <a>converters</a> MUST generate an error</li>
                </ol>
              </li>
            </ol>
          </dd>
          <dt id="table-primaryKey"><code>primaryKey</code></dt>
          <dd>
            <p>
              A <a>column reference property</a> that holds either a single reference to a <a>column description</a> object or an array of references. The value of this property is used to create the value of the <a href="http://w3c.github.io/csvw/syntax/#dfn-row-primary-key" class="externalDFN">primary key</a> annotation for each row within a table that uses this schema by creating a list of the cells in that row that are in the referenced columns.
            </p>
            <p>
              As defined in [[!tabular-data-model]], <a>validators</a> MUST check that each row has a unique combination of cells in the indicated columns. For example, if <code>primaryKey</code> is set to <code>["familyName", "givenName"]</code> then every row must have a unique value for the combination of the <code>familyName</code> and <code>givenName</code> columns.
            </p>
          </dd>
          <dt id="table-foreignKeys"><code>foreignKeys</code></dt>
          <dd>
            <p>
              An <a>array property</a> of <a title="foreign key definition">foreign key definitions</a> that define how the values from specified columns within this table link to rows within this table or other tables. A <dfn>foreign key definition</dfn> is a JSON object with the properties:
            </p>
            <dl>
              <dt id="foreign-key-columns"><code>columns</code></dt>
              <dd>
                <p>A <a>column reference property</a> that holds either a single reference to a <a>column description</a> object within this schema, or an array of references. These form the <dfn>referencing columns</dfn> for the <a>foreign key definition</a>.</p>
              </dd>
              <dt id="foreign-key-reference"><code>reference</code></dt>
              <dd>
                <p>
                  An object that identifies a <dfn>referenced table</dfn> and a set of <dfn>referenced columns</dfn> within that table. Its properties are:
                </p>
                <dl>
                  <dt id="foreign-key-reference-resource"><code>resource</code></dt>
                  <dd>
                    <p>A <a>link property</a> holding a URL that is the identifier for a specific table that is being referenced. If this property is present then <code>tableSchema</code> MUST NOT be present. The <a href="http://w3c.github.io/csvw/syntax/#dfn-table-group" class="externalDFN">table group</a> MUST contain a <a href="http://w3c.github.io/csvw/syntax/#dfn-table" class="externalDFN">table</a> whose <a href="http://w3c.github.io/csvw/syntax/#dfn-table-url" class="externalDFN">url</a> annotation is identical to the <a>property value</a> of this property. That table is the <a>referenced table</a>.</p>
                  </dd>
                  <dt id="foreign-key-reference-schema"><code>tableSchema</code></dt>
                  <dd>
                    <p>A <a>link property</a> holding a URL that is the identifier for a <a>schema</a> that is being referenced. If this property is present then <code>resource</code> MUST NOT be present. The <a href="http://w3c.github.io/csvw/syntax/#dfn-table-group" class="externalDFN">table group</a> MUST contain a <a href="http://w3c.github.io/csvw/syntax/#dfn-table" class="externalDFN">table</a> whose <a href="#table-tableSchema"><code>tableSchema</code></a> <a>property value</a> is identical to the <a>property value</a> of this property, and there MUST NOT be more than one such table. That table is the <a>referenced table</a>.</p>
                  </dd>
                  <dt id="foreign-key-reference-columns"><code>columns</code></dt>
                  <dd>
                    <p>A <a>column reference property</a> that holds either a single reference to a <a>column description</a> object within the <a href="#table-tableSchema"><code>tableSchema</code></a> of the <a>referenced table</a>, or an array of such references.</p>
                  </dd>
                </dl>
                <p>
                  The value of this property is used to create the value of the <a href="http://w3c.github.io/csvw/syntax/#dfn-table-foreign-keys" class="externalDFN">foreign keys</a> annotation on the table using this schema by creating a list of foreign keys comprising a list of columns in the table and a list of columns in the referenced table. The value of this property is also used to create the value of the <a href="http://w3c.github.io/csvw/syntax/#dfn-row-referenced-rows" class="externalDFN">referenced rows</a> annotation on each of the rows in the table that uses this schema, which is a pair of the relevant foreign key and the referenced row in the referenced table.
                </p>
                <p>
                  As defined in [[!tabular-data-model]], <a>validators</a> MUST check that, for each row, the combination of cells in the <a>referencing columns</a> reference a unique row within the <a>referenced table</a> through a combination of cells in the <a>referenced columns</a>. For examples, see <a href="#foreign-key-reference-between-resources" class="sectionRef"></a> and <a href="#foreign-key-reference-between-schemas" class="sectionRef"></a>.
                </p>
              </dd>
            </dl>
            <p class="note">
              It is not required for the resource or schema referenced from a <code>foreignKeys</code> property to have a similarly defined <code>primaryKey</code>, though frequently it will.
            </p>
            <p>
              When an array of foreign key definitions <code>B</code> is <a>merged</a> into an original array of foreign key definitions <code>A</code>, each foreign key definition within <code>B</code> which does not appear within <code>A</code> is appended to the original array <code>A</code>.
            </p>
          </dd>
          <dt id="schema-ld-id"><code>@id</code></dt>
          <dd>
            <p>If included, <code>@id</code> identifies the <a>schema</a> described by this <a>schema description</a>. Publishers MAY include this to provide additional information to JSON-LD based toolchains.</p>
          </dd>
          <dt id="schema-ld-type"><code>@type</code></dt>
          <dd>
            <p>If included, <code>@type</code> MUST be set to <code>"Schema"</code>. Publishers MAY include this to provide additional information to JSON-LD based toolchains.</p>
          </dd>
        </dl>
        <p>
          The description MAY contain any <a title="common property">common properties</a> to provide extra metadata about the schema as a whole.
        </p>
        <p>
          The description MAY contain <a title="inherited property">inherited properties</a> to describe cells within the table.
        </p>
        <section class="informative">
          <h4>Examples</h4>
          <section>
            <h5>Foreign Key Reference Between Resources</h5>
            <p>
              A list of countries is published at <code>http://example.org/countries.csv</code> with the structure:
            </p>
            <pre class="example highlight">
countryCode,latitude,longitude,name
AD,42.546245,1.601554,Andorra
AE,23.424076,53.847818,"United Arab Emirates"
AF,33.93911,67.709953,Afghanistan
            </pre>
            <p>
              Another file contains information about the population in some countries each year, at <code>http://example.com/country_slice.csv</code> with the structure:
            </p>
            <pre class="example highlight">
countryRef,year,population
AF,1960,9616353
AF,1961,9799379
AF,1962,9989846
            </pre>
            <p>
              The following metadata for the group of tables links the two together by defining a <code>foreignKeys</code> property:
            </p>
            <pre class="example highlight">
{
  "@context": "http://www.w3.org/ns/csvw",
  "resources": [{
    "url": "https://example.org/countries.csv",
    "tableSchema": {
      "columns": [{
        "name": "countryCode",
        "datatype": "string"
      }, {
        "name": "latitude",
        "datatype": "number"
      }, {
        "name": "longitude",
        "datatype": "number"
      }, {
        "name": "name",
        "datatype": "string"
      }],
      "primaryKey": "countryCode"
    }
  }, {
    "url": "http://example.com/country_slice.csv",
    "tableSchema": {
      "columns": [{
        "name": "countryRef",
        "datatype": "string"
      }, {
        "name": "year",
        "datatype": "gYear"
      }, {
        "name": "population",
        "datatype": "integer"
      }],
      "foreignKeys": [{
        "columns": "countryRef",
        "reference": {
          "resource": "http://example.org/countries.csv",
          "columns": "countryCode"
        }
      }]
    }
  }]
}
            </pre>
            <p>
              When the population data in <code>country_slice.csv</code> is validated, the <a title="validators">validator</a> must check that every <code>countryRef</code> within <code>country_slice.csv</code> has a matching <code>countryCode</code> within <code>countries.csv</code>.
            </p>
          </section>
          <section>
            <h4>Foreign Key Reference Between Schemas</h4>
            <p>
              When publishing information about public sector roles and salaries, as in <a href="http://w3c.github.io/csvw/csvw-ucr/#UC-OrganogramData">Use Case 4</a>, the UK government requires departments to publish two files which are interlinked. The first lists senior grades (simplified here) eg at <code>HEFCE_organogram_senior_data_31032011.csv</code>:
            </p>
            <pre class="example">
Post Unique Reference,              Name,Grade,             Job Title,Reports to Senior Post
                90115,        Steve Egan,SCS1A,Deputy Chief Executive,                 90334
                90250,     David Sweeney,SCS1A,              Director,                 90334
                90284,       Heather Fry,SCS1A,              Director,                 90334
                90334,Sir Alan Langlands, SCS4,       Chief Executive,                    xx
            </pre>
            <p>
              The second provides information about the number of junior positions that report to those individuals (simplified here) eg at <code>HEFCE_organogram_junior_data_31032011.csv</code>:
            </p>
            <pre class="example">
Reporting Senior Post,Grade,Payscale Minimum (£),Payscale Maximum (£),Generic Job Title,Number of Posts in FTE,          Profession
                90284,    4,               17426,               20002,    Administrator,                     2,Operational Delivery
                90284,    5,               19546,               22478,    Administrator,                     1,Operational Delivery
                90115,    4,               17426,               20002,    Administrator,                  8.67,Operational Delivery
                90115,    5,               19546,               22478,    Administrator,                   0.5,Operational Delivery
            </pre>
            <p>
              The schemas are reused by multiple departments and for multiple pairs of files. The schemas are therefore defined in separate files, and they need to define links between the schemas which are then picked up as applying between tables that use those schemas.
            </p>
            <p>
              The metadata file for the particular publication of the files above is:
            </p>
            <pre class="example highlight">
{
  "@context": "http://www.w3.org/ns/csvw",
  "resources": [{
    "url": "HEFCE_organogram_senior_data_31032011.csv",
    "tableSchema": "http://example.org/schema/senior-roles.json"
  }, {
    "url": "HEFCE_organogram_junior_data_31032011.csv",
    "tableSchema": "http://example.org/schema/junior-roles.json"
  }]
}
            </pre>
            <p>
              The schema for the senior role CSV (at <code>http://example.org/schema/senior-roles.json</code>) is as follows:
            </p>
            <pre class="example highlight">
{
  "@id": "http://example.org/schema/senior-roles.json",
  "@context": "http://www.w3.org/ns/csvw",
  "columns": [{
    "name": "ref",
    "title": "Post Unique Reference"
  }, {
    "name": "name",
    "title": "Name"
  }, {
    "name": "grade",
    "title": "Grade"
  }, {
    "name": "job",
    "title": "Job Title"
  }, {
    "name": "reportsTo",
    "title": "Reports to Senior Post"
  }],
  "primaryKey": "ref"
}
            </pre>
            <p>
              The schema for the junior role CSV (at <code>http://example.org/schema/junior-roles.json</code>) is as follows; it includes a foreign key reference to the senior roles schema:
            </p>
            <pre class="example highlight">
{
  "@id": "http://example.org/schema/junior-roles.json",
  "@context": "http://www.w3.org/ns/csvw",
  "columns": [{
    "name": "reportsTo",
    "title": "Reporting Senior Post"
  }, 
  ...
  ],
  "foreignKeys": [{
    "columns": "reportsTo",
    "reference": {
      "tableSchema": "http://example.org/schema/senior-roles.json",
      "columns": "ref"
    }
  }]
}
            </pre>
            <p>
              In the first line of <code>HEFCE_organogram_junior_data_31032011.csv</code>, the <code>reportsTo</code> (<code>Reporting Senior Post</code>) column contains the value <code>90284</code>. When validating that file, <a>validators</a> will check that there is a single row within the table generated from <code>HEFCE_organogram_senior_data_31032011.csv</code> whose <code>ref</code> column contains the value <code>90284</code>.
            </p>
          </section>
          <section>
            <h4>Weak Linking between Resources</h4>
            <p>
              <a title="foreign key definition">Foreign key definitions</a> provide for strong linking between resources. It is also possible to provide weak linking between resources when converting tabular data into other formats, using <a href="#column-aboutUrl"><code>aboutUrl</code></a> and <a href="#column-valueUrl"><code>valueUrl</code></a>.
            </p>
            <p>
              Taking the example above as a starting point, the schema for <code>HEFCE_organogram_senior_data_31032011.csv</code> could use <a href="#column-aboutUrl"><code>aboutUrl</code></a> to provide a URL for each row, which can similarly be created as a <a href="#column-valueUrl"><code>valueUrl</code></a> for the <code>reportsTo</code> column:
            </p>
            <pre class="example highlight">
{
  "@id": "http://example.org/schema/senior-roles.json",
  "@context": "http://www.w3.org/ns/csvw",
  <strong>"aboutUrl": "#role-{ref}",</strong>
  "columns": [{
    "name": "ref",
    "title": "Post Unique Reference"
  }, {
    "name": "name",
    "title": "Name"
  }, {
    "name": "grade",
    "title": "Grade"
  }, {
    "name": "job",
    "title": "Job Title"
  }, {
    "name": "reportsTo",
    "title": "Reports to Senior Post",
    <strong>"valueUrl": "#role-{reportsTo}"</strong>
  }],
  "primaryKey": "ref"
}
            </pre>
            <p>
              The URLs generated for the values of the <code>reportsTo</code> will (if the data is correct) match the URLs generated for each row within the table. There will be no error, however, if there is a value in the <code>reportsTo</code> column that does not match a value in the <code>ref</code> column.
            </p>
          </section>
        </section>
      </section>
      <section>
        <h3>Columns</h3>
        <p>
          A <dfn>column description</dfn> is a simple JSON object that describes a single column. The description provides additional human-readable documentation for a column, as well as additional information that may be used to validate the cells within the column, create a user interface for data entry, or inform conversion into other formats.
        </p>
        <section>
          <h4>Optional Properties</h4>
          <dl>
            <dt id="column-name"><code>name</code></dt>
            <dd>
              <p>
                An <a>atomic property</a> that gives a single canonical name for the column. The value of this property is used to create the value of the <a href="http://w3c.github.io/csvw/syntax/#dfn-column-name" class="externalDFN">name</a> annotation for the described column. This MUST be a string. Conversion specifications MUST use this property as the basis for the names of properties/elements/attributes in the results of conversions.
              </p>
              <p>The <a>property value</a> of <code>name</code> is that defined within metadata, if it exists. Otherwise, it is the first value from the <a>property value</a> of <code>title</code> having the same language tag as <a>default language</a> or <code>und</code> of not specified percent-encoded as necessary to conform to the syntactic requirements described below, as a string without language, if any. Otherwise, it is the string <code>"_col.<em>[N]</em>"</code> where <code><em>[N]</em></code> is the <a href="http://w3c.github.io/csvw/syntax/#dfn-column-number" class="externalDFN">column number</a>.
              </p>
              <p>
                For ease of reference within <a title="URI template property">URI template properties</a>, column names MUST consist only of alphanumeric characters, underscores, or <code>"."</code> (matching <code>[a-zA-Z0-9][a-zA-Z0-9_\.]*</code>). Names beginning with <code>"_"</code> are reserved by this specification and MUST NOT be used.
              </p>
              <p>
                During validation, if there is no <code>title</code> property and the column already has a <code>title</code> annotation then <a>validators</a> MUST issue a warning if the existing <code>title</code> annotation does not match the <code>name</code> specified in the column description.
              </p>
            </dd>
            <dt id="column-title"><code>title</code></dt>
            <dd>
              <p>
                A <a>natural language property</a> that provides possible alternative names for the column. The value of this property is used to create the value of the <a href="http://w3c.github.io/csvw/syntax/#dfn-column-titles" class="externalDFN">titles</a> annotation for the described column.
              </p>
              <p class="issue" data-number="56">
                The facility to specify multiple potential titles for a column is important when the same column description is used for multiple CSVs, through a mechanism yet to be defined by this specification.
              </p>
            </dd>
            <dt id="column-required"><code>required</code></dt>
            <dd>
              <p>A boolean <a>atomic property</a> taking a single value which indicates whether every cell within the column must have a non-null value. The value of this property is used to create the value of the <a href="http://w3c.github.io/csvw/syntax/#dfn-column-required" class="externalDFN">required</a> annotation for the described column. Its <a>property value</a> is that defined in metadata, or <code>false</code> otherwise.</p>
            </dd>
            <dt id="column-suppressOutput"><code>suppressOutput</code></dt>
            <dd>
              <p>A boolean <a>atomic property</a>. If <code>true</code>, suppresses any output that would be generated when converting cells in this column. The value of this property is used to create the value of the <a href="http://w3c.github.io/csvw/syntax/#dfn-column-suppress-output" class="externalDFN">suppress output</a> annotation for the described column.</p>
            </dd>
            <dt id="column-virtual"><code>virtual</code></dt>
            <dd>
              <p>A boolean <a>atomic property</a> taking a single value which indicates whether the column is a <a href="http://w3c.github.io/csvw/syntax/#dfn-virtual-column" class="externalDFN">virtual column</a> not present in the original source. The value of this property is used to create the value of the <a href="http://w3c.github.io/csvw/syntax/#dfn-column-virtual" class="externalDFN">virtual</a> annotation for the described column. If present, a virtual column MUST appear after all other non-virtual column definitions.</p>
              <p class="note">Virtual columns are useful for inserting cells with default values into an <a href="http://w3c.github.io/csvw/syntax/#dfn-annotated-table" class="externalDFN">annotated table</a> to control the results of conversions.</p>
              <p class="issue" data-number="179">We invite comment on whether <a href="http://w3c.github.io/csvw/syntax/#dfn-virtual-column" class="externalDFN">virtual columns</a> are useful enough to include in the final recommendation in spite of the added complexity.</p>
            </dd>
            <dt id="column-ld-id"><code>@id</code></dt>
            <dd>
              <p>If included, <code>@id</code> identifies the <a href="http://w3c.github.io/csvw/syntax/#dfn-column" class="externalDFN">columns</a>, as defined in [[!tabular-data-model]] and potentially appearing across separate tables, described by this <a>column description</a>. Publishers MAY include this to provide additional information to JSON-LD based toolchains.</p>
            </dd>
            <dt id="column-ld-type"><code>@type</code></dt>
            <dd>
              <p>
                If included, <code>@type</code> MUST be set to <code>"Column"</code>. Publishers MAY include this to provide additional information to JSON-LD based toolchains.
              </p>
            </dd>
          </dl>
          <p>
            The description MAY contain any <a title="common property">common properties</a> to provide extra metadata about the column as a whole, such as a full description.
          </p>
          <p>
            The description MAY contain <a title="inherited property">inherited properties</a> to describe cells within the column.
          </p>
          <section class="informative">
            <h3>Examples</h3>
            <section>
              <h4>Use of <code>virtual</code> columns</h4>
              <p>
                Virtual columns are useful when data needs to be added as part of an output transformation that doesn't exist in the source file. This may be to add type information to a column, or to relate different columns having different <code>aboutUrl</code>. For example, the <code>http://example.org/tree-ops.csv</code> example used in the introduction can be used with the following metadata:
              </p>
              <pre class="example highlight">
{
  "url": "tree-ops.csv",
  "@context": ["http://www.w3.org/ns/csvw", {"@language": "en"}],
  "tableSchema": {
    "aboutUrl": "#gid-{GID}",
    "columns": [{
      "name": "GID",
      "title": "GID",
      "datatype": "string",
      "propertyUrl": "schema:url",
      "valueUrl": "#gid-{GID}"
    }, {
      "name": "on_street",
      "title": "On Street",
      "datatype": "string",
      "aboutUrl": "#location-{GID}",
      "propertyUrl": "schema:streetAddress"
    }, {
      "name": "species",
      "title": "Species",
      "datatype": "string",
      "propertyUrl": "schema:name"
    }, {
      "name": "trim_cycle",
      "title": "Trim Cycle",
      "datatype": "string"
    }, {
      "name": "inventory_date",
      "title": "Inventory Date",
      "datatype": {
        "base": "date",
        "format": "M/d/yyyy"
      },
      "aboutUrl": "#event-{inventory_date}",
      "propertyUrl": "schema:startDate"
    }, {
      "propertyUrl": "schema:event",
      "valueUrl": "#event-{inventory_date}",
      "virtual": true
    }, {
      "aboutUrl": "#event-{inventory_date}",
      "propertyUrl": "rdf:type",
      "valueUrl": "schema:Event",
      "virtual": true
    }, {
      "propertyUrl": "schema:location",
      "valueUrl": "#location-{GID}",
      "virtual": true
    }, {
      "aboutUrl": "#location-{GID}",
      "propertyUrl": "rdf:type",
      "valueUrl": "schema:PostalAddress",
      "virtual": true
    }]
  }
}
              </pre>
              <p>
                This metadata creates a relationship model between data in each column by different combinations of <code>aboutUrl</code>, <code>propertyUrl</code>, and <code>valueUrl</code> on existing columns, and defining new <em>virtual</em> columns to supply additional information. In this case, the <code>on_street</code> and <code>inventory_date</code> values are split into separate entities, each having their own <code>aboutUrl</code>. New <em>virtual</em> columns are defined to provide a location type, and to relate the main row entity to the event and location associated with it. The result of converting the table to RDF would include the following, for the first row, with the contributions from the <a href="http://w3c.github.io/csvw/syntax/#dfn-virtual-column" class="externalDFN">virtual columns</a> highlighted:
              </p>
              <pre class="example highlight">
&lt;#gid-1&gt;
  schema:url &lt;#gid-1&gt; ;
  schema:name "Celtis australis" ;
  :trim_cycle "Large Tree Routine Prune" ;
  <b>schema:event &lt;#event-2010-10-18&gt; ;</b>
  <b>schema:location &lt;#location-1&gt; ;</b>
  .

<b>&lt;#event-1&gt; a schema:Event ;</b>
  schema:startDate "2010-10-18"^^xsd:date ;
  .

<b>&lt;#location-1&gt; a schema:PostalAddress ;</b>
  schema:streetAddress "ADDISON AV" ;
  .
              </pre>
              <p>
                The JSON would similarly include, again with the contributions from the <a href="http://w3c.github.io/csvw/syntax/#dfn-virtual-column" class="externalDFN">virtual columns</a> highlighted:
              </p>
              <pre class="example highlight">
{
  "@id": "#gid-1",
  "schema:url": "#gid-1",
  "schema:name": "Celtis australis",
  "trim_cycle": "Large Tree Routine Prune",
  <b>"schema:event": {
    "@id": "#event-1",</b>
    <b>"@type": "schema:Event",</b>
    "schema:startDate": "2010-10-18"
  },
  <b>"schema:location": {
    "@id": "#location-1",</b>
    <b>"@type": "schema:PostalAddress",</b>
    "schema:streetAddress": "ADDISON AV"
  }
}
              </pre>
            </section>
          </section>
        </section>
      </section>
      <section>
        <h2>Inherited Properties</h2>
        <p>
          A <a href="http://w3c.github.io/csvw/syntax/#dfn-cell" class="externalDFN">cell</a> may be assigned annotations based on properties on the description objects for the <a title="table group description">group of tables</a>, <a title="table description">table</a>, <a title="schema description">schema</a> or <a title="column description">column</a> that it appears in. These properties are known as <dfn title="inherited property">inherited properties</dfn> and are listed below. To ascertain a value for certain annotations on cells, an application MUST identify the relevant property in the descriptions of the group of tables, table, schema or column.
        </p>
        <p>
          Applications MUST raise an error if the value of a property in a <a>table description</a> is not <a>compatible with</a> the value of that property on the <a>table group description</a> it appears in. Applications MUST raise an error if the value of a property in a <a>schema description</a> is not <a>compatible with</a> the value of that property on the <a>table description</a> and <a>table group description</a> it appears in. Applications MUST raise an error if the value of a property in a <a>column description</a> is not <a>compatible with</a> the value of that property in the <a>schema description</a>, <a>table description</a> and/or <a>table group description</a> it appears in.
        </p>
        <p>
          A value for an <a>inherited property</a> on a column or table description is <dfn>compatible with</dfn> with an inherited value on the same property on a table or table group description if they are the same value or if the first value is a sub-value of the second value. The definitions of individual <a title="inherited property">inherited properties</a> indicate what values count as sub-values of others.
        </p>
        <dl>
          <dt id="cell-null"><code>null</code></dt>
          <dd>
            <p>
              An <a>atomic property</a> giving the string or strings used for null values within the data. If the <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-string-value" class="externalDFN">string value</a> of the cell is equal to any one of these values, the <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-value" class="externalDFN">cell value</a> is <code>null</code>. If not specified, the default for the <code>null</code> property is the empty string. A value for this property is <a>compatible with</a> an inherited value if it is a subset of the inherited value.
            </p>
          </dd>
          <dt id="cell-language"><code>lang</code></dt>
          <dd>
            <p>
              An <a>atomic property</a> giving a single string language code as defined by [[!BCP47]]. Indicates the language of the value within the cell. A value for this property is <a>compatible with</a> an inherited value if it is a sub-language of the inherited value; for example <code>en-US</code> is compatible with <code>en</code> but not <code>fr</code>.
            </p>
          </dd>
          <dt id="cell-textDirection"><code>textDirection</code></dt>
          <dd>
            <p>
              An <a>atomic property</a> that MUST have a single string value that is one of <code>"rtl"</code> or <code>"ltr"</code> (the default). Indicates whether the text within cells should be displayed by default as left-to-right or right-to-left text. The value of this property is used to create the value of the <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-text-direction" class="externalDFN">text direction</a> annotation for the cell. A value for this property is <a>compatible with</a> an inherited value only if they are identical.
            </p>
          </dd>
          <dt id="cell-separator"><code>separator</code></dt>
          <dd>
            <p>
              An <a>atomic property</a> that MUST have a single string value that is the character used to separate items in the string value of the cell. If <code>null</code> or unspecified, the cell does not contain a list. Otherwise, application MUST split the string value of the cell on the specified separator character and parse each of the resulting strings separately. The cell's value will then be a list. Conversion specifications MUST use the separator to determine the conversion of a cell into the target format. See <a href="#parsing-cells"></a> for more details. A value for this property is <a>compatible with</a> an inherited value only if they are identical.
            </p>
          </dd>
          <dt id="cell-ordered"><code>ordered</code></dt>
          <dd>
            <p>A boolean <a>atomic property</a> taking a single value which indicates whether a list that is the value of the cell is ordered (if <code>true</code>) or unordered (if <code>false</code>). The default is <code>false</code>. This property is irrelevant if the <a href="#cell-separator"><code>separator</code></a> is <code>null</code> or undefined, but this is not an error. A value for this property is <a>compatible with</a> an inherited value only if they are identical.</p>
          </dd>
          <dt id="cell-default"><code>default</code></dt>
          <dd>
            <p>
              An <a>atomic property</a> holding a single string that is used to create a default <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-value" class="externalDFN">value</a> for the cell in cases where the original <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-string-value" class="externalDFN">string value</a> is an empty string. This default value MAY be used when converting the table into other formats, or when the table is displayed. If not specified, the default for the <code>default</code> property is the empty string, <code>""</code>. A value for this property is <a>compatible with</a> an inherited value only if they are identical.
            </p>
          </dd>
          <dt id="cell-datatype"><code>datatype</code></dt>
          <dd>
            <p>
              An <a>atomic property</a> that contains either a single string that is the main datatype of the values of the cell or a <a>datatype description</a> object. If the value of this property is a string, it is a term defined in the default context representing a built-in datatype URL; if it is an object then it describes a more specialised datatype. If a cell contains a sequence (ie the <code>separator</code> property is specified and not <code>null</code>) then this property specifies the datatype of each value within that sequence. See <a href="#datatypes"></a> for more details.
            </p>
            <p>
              A value for this property is <a>compatible with</a> an inherited value if they are identical, or if the value is a subtype within the datatype hierarchy defined in <a href="#datatypes" class="sectionRef"></a>, including if the inherited value is explicitly specified as the <a href="#datatype-base"><code>base</code></a> of this value.
            </p>
          </dd>
          <dt id="cell-aboutUrl"><code>aboutUrl</code></dt>
          <dd>
            <p>A <a>URI template property</a> that MAY be used to create a unique identifier for each cell within a row when mapping data to other formats. A value for this property is <a>compatible with</a> an inherited value only if they are identical. The value of this property is used to create the value of the <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-about-url" class="externalDFN">about URL</a> annotation for the cell.</p>
            <p class="note"><code>aboutUrl</code> is typically defined on a <a>schema description</a> or <a>table description</a>. If defined on individual <a title="column description">column descriptions</a>, care must be taken to ensure that transformed cell values maintain a semantic relationship.</p>
          </dd>
          <dt id="cell-propertyUrl"><code>propertyUrl</code></dt>
          <dd>
            <p>An <a>URI template property</a> that MAY be used to create a URI for a property if the table is mapped to another format. The default value of <code>propertyUrl</code> is <code>"{#_name}"</code>. A value for this property is <a>compatible with</a> an inherited value only if they are identical. The value of this property is used to create the value of the <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-property-url" class="externalDFN">property URL</a> annotation for the cell.</p>
            <p class="note"><code>propertyUrl</code> is typically defined on a <a title="column description">column description</a>. If defined on a <a>schema description</a>, <a>table description</a> or <a>table group description</a>, care must be taken to ensure that transformed cell values maintain an appropriate semantic relationship, for example by including the <a href="http://w3c.github.io/csvw/syntax/#dfn-column-name" class="externalDFN">name</a> of the column in the generated URL by using <code>_name</code> in the template.</p>
          </dd>
          <dt id="cell-valueUrl"><code>valueUrl</code></dt>
          <dd>
            <p>An <a>URI template property</a> that is used to map the values to the cells into URLs. See <a href="#parsing-cells" class="sectionRef"></a> for details. A value for this property is <a>compatible with</a> an inherited value only if they are identical. The value of this property is used to create the value of the <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-value-url" class="externalDFN">value URL</a> annotation for the cell.</p>
            <p class="note">
              This allows a <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-value" class="externalDFN">cell value</a> to define one or more RDF <cite><a href="http://www.w3.org/TR/rdf11-concepts/#dfn-resource">resources</a></cite> value of a cell instead of a literal values, as defined in [[rdf-concepts]]. For example, if the value were <code>"{#reference}"</code>, each cell value of a column named <em>reference</em> would be used to create a URI such as <code>http://example.com/#1234</code>, if <code>1234</code> were a cell value of that column.</p>
            <p class="note"><code>valueUrl</code> is typically defined on a <a title="column description">column description</a>. If defined on a <a>schema description</a>, <a>table description</a> or <a>table group description</a>, care must be taken to ensure that transformed cell values maintain an appropriate semantic relationship.</p>
          </dd>
        </dl>
        <p>The <a>property value</a> of an <a>inherited property</a> is the first value, if any, found by looking in the current description object through all of its containing objects: a <a>inherited property</a> defined in a <a>column description</a> takes precedence of one defined in a <a>schema description</a>, which in turn takes precedence of one defined in a <a>table description</a>, which in turn takes precedence of one defined in a <a>table group description</a>.</p>
      </section>
      <section>
        <h2>Datatypes</h2>
        <p>
          Cells within tables may be annotated with a <code>datatype</code> which indicates the type of the values obtained by parsing the <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-string-value" class="externalDFN">string value</a> of the cell. See <a href="#parsing-cells"></a> for details of how string values are parsed against datatypes.
        </p>
        <section>
          <h3>Built-in Datatypes</h3>
          <p>
            The possible built-in datatypes are:
          </p>
          <ul>
            <li>
              <p>the datatypes defined in [[!xmlschema11-2]] as derived from and including <code>anyAtomicType</code>, as shown in <a href="#fig-datatypes" class="sectionRef"></a>, with the exception of those that rely on XML mechanisms for definition, namely those in the diagram except:</p>
              <ul>
                <li><code>anyType</code></li>
                <li><code>anySimpleType</code></li>
                <li><code>ENTITIES</code></li>
                <li><code>IDREFS</code></li>
                <li><code>NMTOKENS</code></li>
                <li><code>ENTITY</code></li>
                <li><code>ID</code></li>
                <li><code>IDREF</code></li>
                <li><code>NOTATION</code></li>
              </ul>
            </li>
            <li>the datatype <code>number</code> which is exactly equivalent to <code>double</code></li>
            <li>the datatype <code>binary</code> which is exactly equivalent to <code>base64Binary</code></li>
            <li>the datatype <code>datetime</code> which is exactly equivalent to <code>dateTime</code></li>
            <li>the datatype <code>any</code> which is exactly equivalent to <code>anyAtomicType</code></li>
            <li>the datatype <code>xml</code>, a sub-type of <code>string</code> which indicates the value is an XML fragment</li>
            <li>the datatype <code>html</code>, a sub-type of <code>string</code> which indicates the value is an HTML fragment</li>
            <li>the datatype <code>json</code>, a sub-type of <code>string</code> which indicates the value is serialized JSON</li>
          </ul>
          <figure id="fig-datatypes">
            <img src="http://www.w3.org/TR/xmlschema11-2/type-hierarchy-201104.png" width="810" height="1060" alt="Built-in Datatype Hierarchy diagram" longdesc="http://www.w3.org/TR/xmlschema11-2/type-hierarchy-201104.longdesc.html"/>
            <figcaption>Diagram showing the built-in datatypes from [[!xmlschema11-2]]</figcaption>
          </figure>
        </section>
        <section>
          <h4>Derived Datatypes</h4>
          <p>
            More specialised datatypes can be defined through a <dfn>datatype description</dfn>. A datatype description may have any of the following properties, all of which are optional.
          </p>
          <dl>
            <dt id="datatype-base"><code>base</code></dt>
            <dd>
              <p>
                An <a>atomic property</a> that contains a single string: a term defined in the default context representing a built-in datatype URL, as listed above. If this property is missing, its default is <code>string</code>. All values of the datatype MUST be valid values of the base datatype.
              </p>
            </dd>
            <dt id="datatype-format"><code>format</code></dt>
            <dd>
              <p>
                An <a>atomic property</a> that contains either a single string or an object that defines the format of a value of this type, used when parsing a string value as described in <a href="#parsing-cells"></a>.
              </p>
            </dd>
            <dt id="datatype-length"><code>length</code></dt>
            <dd>
              <p>
                An <a>atomic property</a> that contains a single integer that is the exact length of the value. See <a href="#length-constraints" class="sectionRef"></a> for details.
              </p>
            </dd>
            <dt id="datatype-minLength"><code>minLength</code></dt>
            <dd>
              <p>
                An <a>atomic property</a> that contains a single integer that is the minimum length of the value. See <a href="#length-constraints" class="sectionRef"></a> for details.
              </p>
            </dd>
            <dt id="datatype-maxLength"><code>maxLength</code></dt>
            <dd>
              <p>
                An <a>atomic property</a> that contains a single integer that is the maximum length of the value. See <a href="#length-constraints" class="sectionRef"></a> for details.
              </p>
            </dd>
            <dt id="datatype-minimum"><code>minimum</code></dt>
            <dd>
              <p>
                An <a>atomic property</a> that contains a single number that is the minimum valid value (inclusive); equivalent to <code>minInclusive</code>. See <a href="#value-constraints" class="sectionRef"></a> for details.
              </p>
            </dd>
            <dt id="datatype-maximum"><code>maximum</code></dt>
            <dd>
              <p>
                An <a>atomic property</a> that contains a single number that is the maximum valid value (inclusive); equivalent to <code>maxInclusive</code>. See <a href="#value-constraints" class="sectionRef"></a> for details.
              </p>
            </dd>
            <dt id="datatype-minInclusive"><code>minInclusive</code></dt>
            <dd>
              <p>
                An <a>atomic property</a> that contains a single number that is the minimum valid value (inclusive). See <a href="#value-constraints" class="sectionRef"></a> for details.
              </p>
            </dd>
            <dt id="datatype-maxInclusive"><code>maxInclusive</code></dt>
            <dd>
              <p>
                An <a>atomic property</a> that contains a single number that is the maximum valid value (inclusive). See <a href="#value-constraints" class="sectionRef"></a> for details.
              </p>
            </dd>
            <dt id="datatype-minExclusive"><code>minExclusive</code></dt>
            <dd>
              <p>
                An <a>atomic property</a> that contains a single number that is the minimum valid value (exclusive). See <a href="#value-constraints" class="sectionRef"></a> for details.
              </p>
            </dd>
            <dt id="datatype-maxExclusive"><code>maxExclusive</code></dt>
            <dd>
              <p>
                An <a>atomic property</a> that contains a single number that is the maximum valid value (exclusive). See <a href="#value-constraints" class="sectionRef"></a> for details.
              </p>
            </dd>
          </dl>
          <p>
            The <a>datatype description</a> MAY contain any <a title="common property">common properties</a> to provide extra metadata about the datatype, such as a title or description.
          </p>
        </section>
        <section>
          <h3>Length Constraints</h3>
          <p>
            The <code>length</code>, <code>minLength</code> and <code>maxLength</code> properties indicate the exact, minimum and maximum lengths of values of a datatype.
          </p>
          <p>
            Applications MUST raise an error if both <code>length</code> and <code>minLength</code> are specified and they do not have the same value. Similarly, applications MUST raise an error if both <code>length</code> and <code>maxLength</code> are specified and they do not have the same value. Applications MUST raise an error if <code>length</code>, <code>maxLength</code> or <code>minLength</code> are specified and the <a href="#datatype-base"><code>base</code></a> datatype is not <code>string</code> or one of its subtypes, or a binary type.
          </p>
          <p>
            The length of a value is determined as follows:
          </p>
          <ul>
            <li>if the value is <code>null</code>, its length is zero</li>
            <li>if the value is a string or one of its subtypes, its length is the number of characters in the value</li>
            <li>if the value is of a binary type, its length is the number of bytes in the binary value</li>
          </ul>
        </section>
        <section>
          <h3>Value Constraints</h3>
          <p>
            The <code>minimum</code>, <code>maximum</code>, <code>minInclusive</code>, <code>maxInclusive</code>, <code>minExclusive</code> and <code>maxExclusive</code> properties indicate limits on values of a datatype. These apply to numeric, date/time and duration types.
          </p>
          <p>
            In all ways, including the errors described below, the <code>minimum</code> property is equivalent to the <code>minInclusive</code> property and the <code>maximum</code> property is equivalent to the <code>maxInclusive</code> property. Applications MUST raise an error if both <code>minimum</code> and <code>minInclusive</code> are specified and they do not have the same value. Similarly, applications MUST raise an error if both <code>maximum</code> and <code>maxInclusive</code> are specified and they do not have the same value.
          </p>
          <p>
            Applications MUST raise an error if both <code>minInclusive</code> and <code>minExclusive</code> are specified, or if both <code>maxInclusive</code> and <code>maxExclusive</code> are specified. Applications MUST raise an error if both <code>minInclusive</code> and <code>maxInclusive</code> are specified and <code>maxInclusive</code> is less than <code>minInclusive</code>, or if both <code>minInclusive</code> and <code>maxExclusive</code> are specified and <code>maxExclusive</code> is less than or equal to <code>minInclusive</code>. Similarly, applications MUST raise an error if both <code>minExclusive</code> and <code>maxExclusive</code> are specified and <code>maxExclusive</code> is less than <code>minExclusive</code>, or if both <code>minExclusive</code> and <code>maxInclusive</code> are specified and <code>maxInclusive</code> is less than or equal to <code>minExclusive</code>.
          </p>
          <p>
            Applications MUST raise an error if <code>minimum</code>, <code>minInclusive</code>, <code>maximum</code>, <code>maxInclusive</code>, <code>minExclusive</code> or <code>maxExclusive</code> are specified and the <a href="#datatype-base"><code>base</code></a> datatype is not a numeric, date/time or duration type.
          </p>
          <p>
            Validation against these properties is as defined in [[!xmlschema11-2]].
          </p>
        </section>
      </section>
      <section>
        <h2>Parsing cells</h2>
        <p>
          Unlike many other data formats, tabular data is designed to be read by humans. For that reason, it's common for data to be represented within tabular data in a human-readable way. The <a href="#cell-null"><code>null</code></a>, <a href="#cell-default"><code>default</code></a>, <a href="#cell-separator"><code>separator</code></a>, <a href="#cell-datatype"><code>datatype</code></a>, <a href="#datatype-format"><code>format</code></a> and <a href="#cell-lang"><code>lang</code></a> properties provide the information needed to parse the <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-string-value" class="externalDFN">string value</a> of a cell into its (semantic) <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-value" class="externalDFN">value</a>. This is used:
        </p>
        <ul>
          <li>by <strong>validators</strong> to check that the data in the table is in the expected format</li>
          <li>by <strong>converters</strong> to parse the values before mapping them into values in the target of the conversion</li>
          <li>when <strong>displaying</strong> data, to map it into formats that are meaningful for those viewing the data (as opposed to those publishing it)</li>
          <li>when <strong>inputting</strong> data, to turn entered values into representations in a consistent format</li>
        </ul>
        <p>
          After parsing, the <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-value" class="externalDFN">cell value</a> can be:    
        </p>   
        <ul>   
          <li><code>null</code></li>   
          <li>a single value with an associated optional datatype or language</li>   
          <li>a sequence of such values</li>   
        </ul>
        <p>
          The process of parsing the string value of a cell into a single value or a list of values is as follows:
        </p>
        <ol class="algorithm">
          <li>unless the <a href="#cell-datatype"><code>datatype</code></a> is <code>string</code>, <code>json</code>, <code>xml</code>, <code>html</code>, <code>anyAtomicType</code> or <code>any</code>, replace all carriage return (<code>#xD</code>), line feed (<code>#xA</code>) and tab (<code>#x9</code>) characters with space characters</li>
          <li>unless the <a href="#cell-datatype"><code>datatype</code></a> is <code>string</code>, <code>json</code>, <code>xml</code>, <code>html</code>, <code>anyAtomicType</code>, <code>any</code> or <code>normalizedString</code>, strip leading and trailing whitespace from the <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-string-value" class="externalDFN">string value</a> and replace all instances of two or more whitespace characters with a single space character</li>
          <li>if the resulting string is an empty string, apply the remaining steps to the string given by the <a href="#cell-default"><code>default</code></a> property</li>
          <li>if the <a href="#cell-separator"><code>separator</code></a> property is not <code>null</code> and the resulting string is an empty string, the <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-value" class="externalDFN">cell value</a> is an empty list</li>
          <li>if the <a href="#cell-separator"><code>separator</code></a> property is not <code>null</code>, the <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-value" class="externalDFN">cell value</a> is a list of values created by:
            <ol class="algorithm">
              <li>if the normalized string is an empty string, apply the remaining steps to the string given by the <a href="#cell-default"><code>default</code></a> property</li>
              <li>if the normalized string is the same as any one of the values of the <a href="#cell-null"><code>null</code></a> property, then the resulting value is <code>null</code></li>
              <li>split the normalized string at the character specified by the <code>separator</code> property</li>
              <li>unless the <a href="#cell-datatype"><code>datatype</code></a> is <code>string</code> or <code>anyAtomicType</code> or <code>any</code>, strip leading and trailing whitespace from these strings</li>
              <li>applying the remaining steps to each of the strings in turn</li>
            </ol>
          </li>
          <li>if the string is an empty string, apply the remaining steps to the string given by the <a href="#cell-default"><code>default</code></a> property</li>
          <li>if the string is the same as any one of the values of the <a href="#cell-null"><code>null</code></a> property, then the resulting value is <code>null</code></li>
          <li>validate the string based on the datatype, using the <a href="#datatype-format"><code>format</code></a> property if one is specified, as described below, and then against the constraints described in <a href="#datatypes" class="sectionRef"></a>; if there are any errors, add them to the list of <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-errors" class="externalDFN">errors</a> for the cell; the resulting value is typed as a <code>string</code> with the language provided by the <a href="#cell-lang"><code>lang</code></a> property</li>
          <li>otherwise, if there are no errors, parse the string using the <a href="#datatype-format"><code>format</code></a> if one is specified, as described below; the resulting value is typed according to the <a href="#cell-datatype"><code>datatype</code></a> and if the <code>datatype</code> is <code>string</code>, or there is no <code>datatype</code>, it has the language provided by the <a href="#cell-lang"><code>lang</code></a> property</li>
        </ol>
        <section class="informative">
          <h3>Parsing examples</h3>
          <p>
            When no metadata is available, the <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-value" class="externalDFN">value</a> of a cell is the same as its <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-string-value" class="externalDFN">string value</a>. For example, a cell with a string value of <code>"99"</code> would similarly have the (semantic) value <code>"99"</code>.
          </p>
          <p>
            If a <a href="#cell-datatype"><code>datatype</code></a> is provided for the cell, that is used to create a (semantic) value for the cell. For example, if the metadata contains:
          </p>
          <pre class="example highlight">
"datatype": "integer"
          </pre>
          <p>
            for the cell with the string value <code>"99"</code> then the value of that cell will be the integer <code>99</code>. A cell whose string value was not a valid integer (such as <code>"one"</code> or <code>"1.0"</code>) would be assigned that string value as its (semantic) value, but also have a validation error listed in its <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-errors" class="externalDFN">errors</a> annotation.
          </p>
          <p>
            Sometimes data uses special codes to indicate unknown or null values. For example, a particular column might contain a number that is expected to be between <code>1</code> and <code>10</code>, with the string <code>99</code> used in the original tabular data file to indicate a null value. The metadata for such a column would include:
          </p>
          <pre class="example highlight">
"datatype": {
  "base": "integer",
  "minimum": 1,
  "maximum": 10
},
"null": "99"
          </pre>
          <p>
            In this case, a cell with a string value of <code>"5"</code> would have the (semantic) value of the integer <code>5</code>; a cell with a string value of <code>"99"</code> would have the value <code>null</code>.
          </p>
          <p>
            Similarly, a cell may be assigned a default value if the string value for the cell is empty. A configuration such as:
          </p>
          <pre class="example highlight">
"datatype": {
  "base": "integer",
  "minimum": 1,
  "maximum": 10
},
"default": "5"
          </pre>
          <p>
            In this case, a cell whose string value is <code>""</code> would be assigned the value of the integer <code>5</code>. A cell whose string value contains whitespace, such as a single tab character, would also be assigned the value of the integer <code>5</code>: when the datatype is something other than <code>string</code> or <code>anyAtomicType</code> or <code>any</code>, leading and trailing whitespace is stripped from string values before the remainder of the processing is carried out.
          </p>
          <p>
            Cells can contain sequences of values. For example, a cell might have the string value <code>"1 5 7.0"</code>. In this case, the separator is a space character. The appropriate configuration would be:
          </p>
          <pre class="example highlight">
"datatype": {
  "base": "integer",
  "minimum": 1,
  "maximum": 10
},
"default": "5",
"separator": " "
          </pre>
          <p>
            and this would mean that the cell's value would be an array containing two integers and a string: <code>[1, 5, "7.0"]</code>. The final value of the array is a string because it is not a valid integer; the cell's <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-errors" class="externalDFN">errors</a> annotation will also contain a validation error.
          </p>
          <p>
            Also, with this configuration, if the string value of the cell were <code>""</code> (ie it was an empty cell) the value of the cell would be an empty list.
          </p>
          <p>
            A <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-value" class="externalDFN">cell value</a> can be inserted into a URL created using a <a>URI template property</a> such as <code>valueUrl</code>. For example, if a cell with the <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-string-value" class="externalDFN">string value</a> <code>"1 5 7.0"</code> were in a column named <code>values</code>, defined with:
          </p>
          <pre class="example highlight">
"datatype": "decimal",
"separator": " ",
"valueUrl": "{?values}"
          </pre>
          <p>
            then after expansion of the URI template, the resulting <code>valueUrl</code> would be <code>?values=1.0,5.0,7.0</code>. The canonical representations of the decimal values are used within the URL.
          </p>
        </section>
        <section>
          <h3>Formats for numeric types</h3>
          <p>
            It is not uncommon for numbers within tabular data to be formatted for human consumption, which may involve using commas for decimal points, grouping digits in the number using commas, or adding currency symbols or percent signs to the number.
          </p>
          <p>
            If the <a href="#cell-datatype"><code>datatype</code></a> is a numeric type, the <a href="#datatype-format"><code>format</code></a> property indicates the expected format for that number. Its value MUST be either a single string or an object with one or more of the properties:
          </p>
          <dl>
            <dt id="decimalChar"><code>decimalChar</code></dt>
            <dd>A single character string whose value is used to represent a decimal point within the number. The default value is <code>"."</code>.</dd>
            <dt id="groupChar"><code>groupChar</code></dt>
            <dd>A single character string whose value is used to group digits within the number. The default value is <code>","</code>.</dd>
            <dt id="number-pattern"><code>pattern</code></dt>
            <dd>A regular expression string, in the syntax and interpreted as defined by [[!ECMASCRIPT]].</dd>
          </dl>
          <p class="note">
            Authors are encouraged to be conservative in the regular expressions that they use, sticking to the basic features of regular expressions that are likely to be supported across implementations.
          </p>
          <p>
            If the <a href="#datatype-format"><code>format</code></a> property is a single string, this is interpreted in the same way as if it were an object with a <code>pattern</code> property whose value is that string.
          </p>
          <p>
            When parsing the <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-string-value" class="externalDFN">string value</a> of a cell against this format specification, implementations MUST recognise and parse numbers that consist of:
          </p>
          <ol>
            <li>an optional <code>+</code> or <code>-</code> sign</li>
            <li>followed by a decimal digit (<code>0-9</code>)</li>
            <li>followed by any number of decimal digits (<code>0-9</code>) and the character specified as the <a href="#groupChar"><code>groupChar</code></a></li>
            <li>followed by an optional <a href="#decimalChar"><code>decimalChar</code></a> followed by one or more decimal digits (<code>0-9</code>)</li>
            <li>followed by an optional exponent, consisting of an <code>E</code> followed by an optional <code>+</code> or <code>-</code> sign followed by one or more decimal digits (<code>0-9</code>)</li>
            <li>followed by an optional percent (<code>%</code>) or per-mille (<code>&permil;</code>) sign</li>
          </ol>
          <p>
            or that are one of the special values:
          </p>
          <ol>
            <li><code>NaN</code></li>
            <li><code>INF</code></li>
            <li><code>-INF</code></li>
          </ol>
          <p>
            Implementations MUST add a validation error to the <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-errors" class="externalDFN">errors</a> annotation for the cell if the string being parsed:
          </p>
          <ul>
            <li>does not meet the numeric format defined above</li>
            <li>contains two consecutive <a href="#groupChar"><code>groupChar</code></a> characters</li>
            <li>does not match the regular expression defined in the <a href="#number-pattern"><code>pattern</code></a> property, if there is one</li>
            <li>contains the <a href="#decimalChar"><code>decimalChar</code></a>, if the <a href="#cell-datatype"><code>datatype</code></a> is <code>integer</code> or one of its sub-values</li>
            <li>contains an exponent, if the <a href="#cell-datatype"><code>datatype</code></a> is <code>decimal</code> or one of its sub-values</li>
            <li>is one of the special values <code>NaN</code>, <code>INF</code> or <code>-INF</code>, if the <a href="#cell-datatype"><code>datatype</code></a> is <code>decimal</code> or one of its sub-values</li>
          </ul>
          <p>
            Implementations MUST use the sign, exponent, percent and per-mille signs when parsing the <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-string-value" class="externalDFN">string value</a> of a cell to provide the <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-value" class="externalDFN">value</a> of the cell. For example, the string value <code>"-25%"</code> must be interpreted as <code>-0.25</code> and the string value <code>"1E6"</code> as <code>1000000</code>.
          </p>
        </section>
        <section>
          <h3>Formats for booleans</h3>
          <p>
            Boolean values may be represented in many ways aside from the standard <code>1</code> and <code>0</code> or <code>true</code> and <code>false</code>.
          </p>
          <p>
            If the <a href="#cell-datatype"><code>datatype</code></a> for a cell is <code>boolean</code>, the <a href="#datatype-format"><code>format</code></a> property provides the true and false values expected, separated by <code>|</code>. For example if <code>format</code> is <code>Y|N</code> then cells must hold either <code>Y</code> or <code>N</code> with <code>Y</code> meaning <code>true</code> and <code>N</code> meaning <code>false</code>.
          </p>
          <p>
            The resulting <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-value" class="externalDFN">cell value</a> will be one or more boolean <code>true</code> or <code>false</code> values.
          </p>
        </section>
        <section>
          <h3>Formats for dates and times</h3>
          <p>
            Dates and times are commonly represented in tabular data in formats other than those defined in [[!xmlschema11-2]].
          </p>
          <p>
            If the <a href="#cell-datatype"><code>datatype</code></a> is a date or time type, the <a href="#datatype-format"><code>format</code></a> property indicates the expected format for that date or time.
          </p>
          <p>
            The supported date and time formats listed here are expressed in terms of the <a href="http://www.unicode.org/reports/tr35/tr35-dates.html#Date_Field_Symbol_Table">date field symbols</a> defined in [[!UAX35]] and MUST be interpreted by implementations as defined in that specification.
          </p>
          <p>
            The following date formats MUST be recognised by implementations:
          </p>
          <ul>
            <li><code>yyyy-MM-dd</code> eg <code>2015-03-22</code></li>
            <li><code>yyyyMMdd</code> eg <code>20150322</code></li>
            <li><code>dd-MM-yyyy</code> eg <code>22-03-2015</code></li>
            <li><code>d-M-yyyy</code> eg <code>22-3-2015</code></li>
            <li><code>MM-dd-yyyy</code> eg <code>03-22-2015</code></li>
            <li><code>M-d-yyyy</code> eg <code>3-22-2015</code></li>
            <li><code>dd/MM/yyyy</code> eg <code>22/03/2015</code></li>
            <li><code>d/M/yyyy</code> eg <code>22/3/2015</code></li>
            <li><code>MM/dd/yyyy</code> eg <code>03/22/2015</code></li>
            <li><code>M/d/yyyy</code> eg <code>3/22/2015</code></li>
            <li><code>dd.MM.yyyy</code> eg <code>22.03.2015</code></li>
            <li><code>d.M.yyyy</code> eg <code>22.3.2015</code></li>
            <li><code>MM.dd.yyyy</code> eg <code>03.22.2015</code></li>
            <li><code>M.d.yyyy</code> eg <code>3.22.2015</code></li>
          </ul>
          <p>
            The following time formats MUST be recognised by implementations:
          </p>
          <ul>
            <li><code>HH:mm:ss</code> eg <code>15:02:37</code></li>
            <li><code>HHmmss</code> eg <code>150237</code></li>
            <li><code>HH:mm</code> eg <code>15:02</code></li>
            <li><code>HHmm</code> eg <code>1502</code></li>
          </ul>
          <p>
            The following date/time formats MUST be recognised by implementations:
          </p>
          <ul>
            <li><code>yyyy-MM-ddTHH:mm:ss</code> eg <code>2015-03-15T15:02:37</code></li>
            <li><code>yyyy-MM-ddTHH:mm</code> eg <code>2015-03-15T15:02</code></li>
            <li>any of the date formats above, followed by a single space, followed by any of the time formats above, eg <code>M/d/yyyy HH:mm</code> for <code>3/22/2015 15:02</code> or <code>dd.MM.yyyy HH:mm:ss</code> for <code>22.03.2015 15:02:37</code></li>
          </ul>
          <p>
            Implementations MUST also recognise date, time and date/time formats that end with timezone markers consisting of between one and three <code>x</code>s or <code>X</code>s, possibly after a single space. These MUST be interpreted as follows:
          </p>
          <ul>
            <li><code>X</code> eg <code>-08</code>, <code>+0530</code> or <code>Z</code> (minutes are optional)</li>
            <li><code>XX</code> eg <code>-0800</code>, <code>+0530</code> or <code>Z</code></li>
            <li><code>XXX</code> eg <code>-08:00</code>, <code>+05:30</code> or <code>Z</code></li>
            <li><code>x</code> eg <code>-08</code> or <code>+0530</code> (<code>Z</code> is not permitted)</li>
            <li><code>xx</code> eg <code>-0800</code> or <code>+0530</code> (<code>Z</code> is not permitted)</li>
            <li><code>xxx</code> eg <code>-08:00</code> or <code>+05:30</code> (<code>Z</code> is not permitted)</li>
          </ul>
          <p>
            For example, formats could include <code>yyyy-MM-ddTHH:mm:ssXXX</code> for <code>2015-03-15T15:02:37Z</code> or <code>2015-03-15T15:02:37-05:00</code>, or <code>HH:mm x</code> for <code>15:02 -05</code>.
          </p>
          <p>
            The <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-value" class="externalDFN">cell value</a> will one or more dates/time values extracted using the <code>format</code>.
          </p>
          <p class="note">
            For simplicity, this version of this standard does not support abbreviated or full month or day names, or double digit years. Future versions of this standard may support other date and time formats, or general purpose date/time pattern strings. Authors of schemas SHOULD use appropriate regular expressions, along with the <code>string</code> datatype, for dates and times that use a format other than that specified here.
          </p>
        </section>
        <section>
          <h3>Formats for durations</h3>
          <p>
            Durations MUST be formatted and interpreted as defined in [[!xmlschema11-2]], using the [[!ISO8601]] format <code>-?P<var>n</var>Y<var>n</var>M<var>n</var>DT<var>n</var>H<var>n</var>M<var>n</var>S</code>. For example, the duration <code>P1Y1D</code> is used for a year and a day; the duration <code>PT2H30M</code> for 2 hours and 30 minutes.
          </p>
          <p>
            If the <a href="#cell-datatype"><code>datatype</code></a> is a duration type, the <a href="#datatype-format"><code>format</code></a> property provides a regular expression for the string values, in the syntax and processed as defined by [[!ECMASCRIPT]].
          </p>
          <p class="note">
            Authors are encouraged to be conservative in the regular expressions that they use, sticking to the basic features of regular expressions that are likely to be supported across implementations.
          </p>
          <p>
            The <a href="http://w3c.github.io/csvw/syntax/#dfn-cell-value" class="externalDFN">cell value</a> will be one or more durations extracted using the <code>format</code>.
          </p>
        </section>
        <section>
          <h3>Formats for other types</h3>
          <p>
            If the <a href="#cell-datatype"><code>datatype</code></a> is not numeric, <code>boolean</code>, a date/time type or a duration type, the <code>format</code> property provides a regular expression for the string values, in the syntax and processed as defined by [[!ECMASCRIPT]].
          </p>
          <p class="note">
            Authors are encouraged to be conservative in the regular expressions that they use, sticking to the basic features of regular expressions that are likely to be supported across implementations.
          </p>
          <p>
            Values that are labelled as <code>html</code>, <code>xml</code> or <code>json</code> are not validated against those formats.
          </p>
          <p class="note">
            Metadata creators who wish to check the syntax of HTML, XML or JSON within tabular data should use the <code>format</code> property to specify a regular expression against which such values will be tested.
          </p>
        </section>
      </section>
    </section>
    <section>
      <h2>Merging Metadata</h2>
      <p>
        When processing a tabular data file, the <cite><a href="http://w3c.github.io/csvw/syntax/#locating-metadata">Locating Metadata</a></cite> in [[!tabular-data-model]] describes different locations for locating metadata. To property transform a tabular data file, such as a CSV, processors MUST merge metadata from these separate sources to create a single metadata document in a manner consistent with this algorithm.
      </p>
      <p>Implementations MUST merge metadata documents in a manner consistent with these rules. <a>Validators</a> MUST check and issue warnings where merge issues are found as noted below and in the relevant property definitions.</p>
      <p>
        Merging of metadata happens in order from highest priority to lowest priority by merging the first two metadata files (<code>A</code> and <code>B</code>) together to create new merged metadata AB'. This is then used to merge in the next metadata file until all metadata have been processed to create a <a>table group description</a>. If the top-level object of either of the metadata files are <a title="table description">table descriptions</a>, these are turned into <a title="table group description">table group descriptions</a> containing a single table description (ie having a single <code>resource</code> property whose value is the same as the original table description). Ensure that <code>@context</code> definitions are moved from the <a>table description</a> to the <a>table group description</a>.
      </p>
      <p>
        Merging has two stages: the <a>normalization</a> of metadata documents, described in <a href="#normalization" class="sectionRef"></a> and the <a title="merged">merging</a> of those normalized documents, described in <a href="#merging" class="sectionRef"></a>.
      </p>
      <section>
        <h3>Normalization</h3>
        <p>Prior to merging, each description object is expanded relative to its <code>@context</code> and values are <dfn title="normalization">normalized</dfn> as follows:</p>
        <ol class="algorithm">
          <li>If the property is a <a>link property</a> the value is turned into an absolute URL using the <a>base URL</a>.</li>
          <li>If the property is an <a>object property</a> with a string value, the string is a URL referencing a JSON document containing a single object. Dereference this URL and replace the string value with that object.</li>
          <li>If the property is a <a>natural language property</a> and the value is not already an object, it is turned into an object whose properties are language codes and where the values of those properties are arrays. The suitable language code for the values is determined through the <a>default language</a>; if it can't be determined the language code <code>und</code> MUST be used.</li>
          <li>If the property is an <a>atomic property</a> accepting strings or objects, normalize to the object form as described for that property.</li>
          <li>
            If the property is a <a>common property</a> or <a href="#table-notes"><code>notes</code></a> the value MUST be normalized as follows:
            <ol class="algorithm">
              <li>If the value is an array, each value within the array is normalized in place as described here.</li>
              <li>If the value is a string, replace it with an object with a <code>@value</code> property whose value is that string. If a <a>default language</a> is specified, add a <code>@language</code> property whose value is that default language.</li>
              <li>If the value is an object with a <code>@value</code> property, it remains as is.</li>
              <li>If the value is any other object, normalize each property of that object as follows:
                <ol class="algorithm">
                  <li>If the property is <code>@id</code>, <a title="expansion">expand</a> any prefixes and resolve its value against the <a>base URL</a>.</li>
                  <li>If the property is <code>@type</code>, then if its value (or any of its values if it holds an array) is a relative URL, resolve it against the <a>base URL</a>.</li>
                  <li>Otherwise, normalize the value of the property according to this algorithm.</li>
                </ol>
              </li>
              <li>Otherwise, the value remains as is.</li>
            </ol>
          </li>
        </ol>
        <p>
          Following this normalization process, the <code>@base</code> and <code>@language</code> properties within the <code>@context</code> are no longer relevant; the normalized metadata can have its <code>@context</code> set to <code>http://www.w3.org/ns/csvw</code>.
        </p>
        <section class="informative">
          <h4>Examples</h4>
          <p>The following are examples of how common properties are normalized.</p>
          <p>In this example, a simple string is used as the title for a <a href="http://w3c.github.io/csvw/syntax/#dfn-table" class="externalDFN">table</a>.</p>
          <pre class="example highlight" title="Giving a title to a Table">
{
  "@context": { "http://www.w3.org/ns/csvw", { "@language": "en" } },
  "@type": "Table",
  "url": "http://example.com/table.csv",
  "tableSchema": [...],
  <strong>"dc:title": "The title of this Table"</strong>
}
          </pre>
          <p>Since there is a <a>default language</a>, this is equivalent to explicitly specifying the language of that title:</p>
          <pre class="example highlight" title="Giving a title to a Table">
{
  "@type": "Table",
  "url": "http://example.com/table.csv",
  "tableSchema": [...],
  <strong>"dc:title": {"@value": "The title of this Table", "@language": "en"}</strong>
}
          </pre>
          <p>It is also possible to use a simple <a href="http://www.w3.org/TR/json-ld/#dfn-value-object" class="externalDFN">value object</a> to give a title. However, in this case the <a>default language</a> is not applied to the title:</p>
          <pre class="example highlight" title="Giving a label to a Table">
{
  "@context": { "http://www.w3.org/ns/csvw", { "@language": "en" } },
  "@type": "Table",
  "url": "http://example.com/table.csv",
  "tableSchema": [...],
  <strong>"dc:title": {"@value": "The title of this Table"}</strong>
}
          </pre>
          <p>The next example uses an array of a string and a <a href="http://www.w3.org/TR/json-ld/#dfn-value-object" class="externalDFN">value object</a> to give two titles with different languages:</p>
          <pre class="example highlight" title="Giving a title to a Table">
{
  "@context": { "http://www.w3.org/ns/csvw", { "@language": "en" } },
  "@type": "Table",
  "url": "http://example.com/table.csv",
  "tableSchema": [...],
  <strong>"dc:title": [
    "The title of this Table",
    {"@value": "Der Titel dieser Tabelle", "@language": "de"}
  ]</strong>
}
          </pre>
          <p>
            The normalized version of this is:
          </p>
          <pre class="example highlight" title="Giving a title to a Table">
{
  "@type": "Table",
  "url": "http://example.com/table.csv",
  "tableSchema": [...],
  <strong>"dc:title": [
    {"@value": "The title of this Table", "@language": "en"}
    {"@value": "Der Titel dieser Tabelle", "@language": "de"}
  ]</strong>
}
          </pre>
          <p>The next example demonstrates a <a href="http://www.w3.org/TR/json-ld/#dfn-node-object" class="externalDFN">node object</a>, in which the value of the <code>schema:url</code> property is a reference to another resource:</p>
          <pre class="example highlight" title="Referencing a URL">
{
  "@context": [ "http://www.w3.org/ns/csvw", { "@base": "http://example.com/" } ],
  "@type": "Table",
  "url": "table.csv",
  "tableSchema": [...],
  <strong>"schema:url": {"@id": "table.csv"}</strong>
}
          </pre>
          <p>The value of the <code>@id</code> property is normalized as described in <a href="#normalization" class="sectionRef"></a> against the <a>base URL</a> provided through the <code>@base</code> property, which means the above example is equivalent to:</p>
          <pre class="example highlight" title="Referencing a URL">
{
  "@context": "http://www.w3.org/ns/csvw",
  "@type": "Table",
  "url": "http://example.com/table.csv",
  "tableSchema": [...],
  <strong>"schema:url": {"@id": "http://example.com/table.csv"}</strong>
}
          </pre>
          <p>The following example shows the <code>dc:publisher</code> property as an array that contains a single <a href="http://www.w3.org/TR/json-ld/#dfn-node-object" class="externalDFN">node object</a>:</p>
          <pre class="example highlight" title="Embedded object">
{
  "@context": "http://www.w3.org/ns/csvw",
  "@type": "Table",
  "url": "http://example.com/table.csv",
  "tableSchema": [...],
  <strong>"dc:publisher": [{
    "schema:name": "Example Municipality",
    "schema:url": {"@id": "http://example.org"}
  }]</strong>,
}
          </pre>
        </section>
      </section>
      <section>
        <h3>Merging</h3>
        <p>
          A description object <code>B</code> is <dfn>merged</dfn> into an original description object <code>A</code> by merging each property of <code>B</code> into <code>A</code>. If the property from <code>B</code> does not exist on <code>A</code>, it is simply added to <code>A</code>. If <code>A</code> does have the property, the way the values are merged depends on the type of the property, as follows:
        </p>
        <ul>
          <li>If the property is an <a>array property</a>, the way in which values are merged depends on the property; see the relevant property for this definition.</li>
          <li>If the property is an <a>object property</a> the objects are merged as described here.</li>
          <li>If the property is a <a>natural language property</a>, the result is an object whose properties are language codes and where the values of those properties are arrays. The arrays MUST provide the values from <code>A</code> followed by those from <code>B</code> that were not already a value in <code>A</code>. If a value exists in the array for the undefined language (<code>und</code>) and in the array for any other language, the value from the array for <code>und</code> MUST be removed, ensuring that the <code>und</code> property is removed entirely if it's value becomes an empty array.</li>
          <li>If the property is a <a>common property</a>, the result is an array containing values from <code>A</code> followed by values from <code>B</code>.</li>
          <li>Otherwise, the value from <code>A</code> overrides that from <code>B</code>.</li>
        </ul>
      </section>
      <section class="informative">
        <h3>Example</h3>
      <p>For example, consider the following two Metadata documents to be merged (located at <code>http://example.com/metadata.json</code> and <code>http://example.com/doc1.csv-metadata.json</code>):</p>
      <pre class="example highlight" title="Metadata A to be merged">
{
  "@context": ["http://www.w3.org/ns/csvw", {"@language": "en"}],
  "resources": [{
    "url": "doc1.csv",
    "dc:title": "foo",
    "tableDirection": "ltr",
    "tableSchema": {
      "aboutUrl": "{#foo}",
      "columns": [{
        "name": "foo", 
        "title": "Foo", 
        "required": true
      }, {
        "name": "bar"
      }]
    }
  }, {
    "url": "doc2.csv"
  }]
}
      </pre>
      <pre class="example highlight" title="Metadata B to be merged">
{
  "@context": "http://www.w3.org/ns/csvw",
  "url": "http://example.com/doc1.csv",
  "dc:description": "bar",
  "tableSchema": {
    "propertyUrl": "{#_name}",
    "columns": [{
      "title": "Foo",
      "required": false
    }, {
      "name": "bar"
    }, {
    }]
  }
}
      </pre>
      <p>The process of merging performs the following steps:</p>
      <ol class="algorithm">
        <li>
          Normalize <code>A</code> to use the language specified in the <code>@context</code> within the <a>natural language property</a> <a href="#column-title"><code>title</code></a> and to expand the <a>link property</a> <a href="#table-url"><code>url</code></a> against the <a>base URL</a> for <code>A</code>, <code>http://example.com/metadata.json</code>:
      <pre class="example highlight" title="Metadata A after normalization">
{
  "resources": [{
    "url": "<strong>http://example.com/doc1.csv</strong>",
    "dc:title": <strong>{"@value": "foo", "@language": "en"}</strong>,
    "tableDirection": "ltr",
    "tableSchema": {
      "aboutUrl": "{#foo}",
      "columns": [{
        "name": "foo", 
        "title": <strong>{ "en": [ "Foo" ] }</strong>, 
        "required": true
      }, {
        "name": "bar"
      }]
    }
  }, {
    "url": "<strong>http://example.com/doc2.csv</strong>"
  }]
}
      </pre>
        </li>
        <li>Normalize <code>B</code> from a <a>table description</a> to a <a>table group description</a> by embedding the table description in a <code>resources</code> property, resolve the <a>link property</a> <a href="#table-url"><code>url</code></a> (which is already an absolute URL), and normalize the <a href="#column-title"><code>title</code></a> property to use the <code>und</code> language:
      <pre class="example highlight" title="Metadata B after normalization">
{
  "resources": [{
    "url": "http://example.com/doc1.csv",
    "dc:description": <strong>{"@value": "bar"}</strong>,
    "tableSchema": {
      "propertyUrl": "{#_name}",
      "columns": [{
        "title": <strong>{ "und": [ "Foo" ] }</strong>,
        "required": false
      }, {
        "name": "bar"
      }, {
      }]
    }
  }]
}
      </pre>
        </li>
        <li><code>resources</code> is an <a>array property</a> with rules specified in <a href="#table-groups" class="sectionRef"></a> and each value is merged accordingly:
          <ol class="algorithm">
            <li>The first value from <code>A</code> and <code>B</code> are now the following:
              <pre class="example highlight" title="first resources values from A and B">
{
  "url": "http://example.com/doc1.csv",
  "dc:title": {"@value": "foo", "@language": "en"},
  "tableDirection": "ltr",
  "tableSchema": {
    "aboutUrl": "{#foo}",
    "columns": [{
      "name": "foo", 
      "title": { "en": [ "Foo" ] }, 
      "required": true
    }, {
      "name": "bar"
    }]
  }
}

{
  "url": "http://example.com/doc1.csv",
  "dc:description": {"@value": "bar"},
  "tableSchema": {
    "propertyUrl": "{#_name}",
    "columns": [{
      "title": { "und": [ "Foo" ] },
      "required": false
    }, {
      "name": "bar"
    }, {
    }]
  }
}
              </pre>
              As these have the same <a href="#table-url"><code>url</code></a>, these are merged. Each property from <code>B</code> is considered:
              <ol class="algorithm">
                <li><code>url</code> is the same (otherwise the two <a title="table description">table descriptions</a> would not be being merged</li>
                <li><code>dc:description</code> does not exist in <code>A</code> so it is added to <code>A</code></li>
                <li>The objects held by the <a>object property</a> <code>tableSchema</code> properties are merged:
                  <ol class="algorithm">
                    <li><code>B</code> has a <code>propertyUrl</code> which is added to <code>A</code>.</li>
                    <li>Each has <code>columns</code> which is merged as described in <a href="#schemas"></a>:
                      <ol class="algorithm">
                        <li>The first column matches on <code>title</code> because they each have the value <code>"Foo"</code> and the language tag <code>en</code> matches <code>und</code>. Because the <code>und</code> value is present in the <code>en</code> array, that value is removed from the <code>und</code> array, and because the array is now empty the <code>und</code> property is removed. The value of <code>required</code> in <em>A</em> is retained, as is the value of <code>name</code></li>
                        <li>The second column has a match on <code>name</code></li>
                      </ol>
                    </li>
                  </ol>
                </li>
              </ol>
              The merged table description is now the following:
              <pre class="example highlight" title="first resources values merged">
{
  "url": "http://example.com/doc1.csv",
  "dc:title": {"@value": "foo", "@language": "en"},
  "dc:description": {"@value": "bar"},
  "tableDirection": "ltr",
  "tableSchema": {
    "aboutUrl": "{#foo}",
    "propertyUrl": "{#_name}",
    "columns": [{
      "name": "foo", 
      "title": { "en": [ "Foo" ]}, 
      "required": true
    },{
      "name": "bar"
    }]
  }
}
              </pre>
            </li>
            <li>The second resources value from <code>A</code> is retained as is.</li>
          </ol>
        </li>
      </ol>
      <p>The resulting merged metadata is now the following:</p>
      <pre class="example highlight" title="Fully merged metadata">
{
  "resources": [{
    "url": "http://example.com/doc1.csv",
    "dc:title": {"@value": "foo", "@language": "en"},
    "dc:description": {"@value": "bar"},
    "tableDirection": "ltr",
    "tableSchema": {
      "aboutUrl": "{#foo}",
      "propertyUrl": "{#_name}",
      "columns": [{
        "name": "foo", 
        "title": { "en": [ "Foo" ]}, 
        "required": true
      },{
        "name": "bar"
      }]
    }
  }, {
    "url": "http://example.com/doc2.csv"
  }]
}
      </pre>
    </section>
    </section>
    <section>
      <h2>Security Considerations</h2>
      <p>
        Applications that process tabular data may use that data to drive other actions, which may have security implications. These behaviours are outside the scope of this specification.
      </p>
      <p>
        Third party metadata provided about a tabular data file (such as a CSV file) may rename or ignore headers, or exclude rows or columns, which may lead to data being misinterpreted by applications that process it.
      </p>
      <p>
        <a title="transformation definition">Transformation definitions</a> are a possible security risk as they enable the creators of metadata to reference arbitrary code that may be executed to convert tabular data into other formats. Implementations should run this arbitrary code in a sandboxed environment to reduce the security risk.
      </p>
    </section>
    <section class="appendix">
      <h2>JSON-LD Dialect</h2>
      <p>The Metadata Vocabulary for Tabular Data uses a format based on JSON-LD [[!JSON-LD]] with some restrictions.</p>
      <ul>
        <li>All <a href="http://www.w3.org/TR/json-ld/#dfn-term" class="externalDFN">terms</a> used within a metadata document MUST be defined in the JSON-LD context defined for this specification (see <a href="#json-ld-context" class="sectionRef"></a>).</li>
        <li><p>The value of any <code>@id</code> or <code>@type</code> contained within a metadata document MUST NOT be a <a href="http://www.w3.org/TR/json-ld/#dfn-blank-node" class="externalDFN">blank node</a></p></li>
        <li><p>A metadata document MUST NOT add a new context, or extend the top-level context in anyway other than as specifically allowed in <a href="#top-level-properties" class="sectionRef"></a>.</p></li>
        <li><p>Common properties and notes may contain arbitrary JSON-LD with the following restrictions:</p>
          <ul>
            <li><p>The value of any member of <code>@type</code> MUST be either a <a href="http://www.w3.org/TR/json-ld/#dfn-term" class="externalDFN">term</a> defined in the JSON-LD context, a <a href="http://www.w3.org/TR/json-ld/#dfn-compact-iri" class="externalDFN">prefixed name</a> where the prefix is a <a href="http://www.w3.org/TR/json-ld/#dfn-term" class="externalDFN">term</a> defined in the JSON-LD context, or an absolute URL.</p></li>
            <li><p>Values MAY be a <a href="http://www.w3.org/TR/json-ld/#dfn-string" class="externalDFN">string</a>, native JSON type (such as <a href="http://www.w3.org/TR/json-ld/#dfn-number" class="externalDFN">number</a>, <code>true</code>, or <code>false</code>.), <a href="http://www.w3.org/TR/json-ld/#dfn-value-object" class="externalDFN">value object</a>, <a href="http://www.w3.org/TR/json-ld/#dfn-node-object" class="externalDFN">node object</a> or an array of zero or more any of these.</p></li>
            <li><p>Values MUST NOT use <a href="http://www.w3.org/TR/json-ld/#dfn-list-object" class="externalDFN">list objects</a> or <a href="http://www.w3.org/TR/json-ld/#dfn-set-object" class="externalDFN">set objects</a>.</p></li>
            <li><p>Keys of <a href="http://www.w3.org/TR/json-ld/#dfn-node-object" class="externalDFN">node objects</a> MUST NOT include <code>@graph</code>,  <code>@context</code>, <a href="http://www.w3.org/TR/json-ld/#dfn-term" class="externalDFN">terms</a>, or <a href="http://www.w3.org/TR/json-ld/#dfn-blank-node" class="externalDFN">blank nodes</a>.</p></li>
          </ul>
        </li>
      </ul>
    </section>
    <section class="appendix">
      <h2>Acknowledgements</h2>
      <p>
        This document is largely a copy of content from the <a href="http://dataprotocols.org/data-packages/">Data Package</a> specification and the <a href="http://dataprotocols.org/json-table-schema/">JSON Table Schema</a>, which are maintained as part of <a href="http://dataprotocols.org/">Data Protocols</a>. Particular contributors to that work are Rufus Pollock, Paul Fitzpatrick, Andrew Berkeley, Francis Irving, Benoit Chesneau, Leigh Dodds, Martin Keegan, and Gunnlaugur Thor Briem.
      </p>
    </section>
    <section class="appendix">
      <h2>IANA Considerations</h2>
      <section>
        <h3>Registration of <code>application/csvm+json</code></h3>
        <p class="issue">
          We intend to include a registration for a new datatype, namely <code>application/csvm+json</code>. We invite comment about how to indicate that this is consistent with <code>application/ld+json</code>, or whether we should just use <code>application/json</code> or <code>application/ld+json</code> and not create a specific media type for the metadata files defined in this document.
        </p>
      </section>
    </section>
    <section class="appendix">
      <h2>JSON-LD Context</h2>
      <p>
        The JSON-LD context, located at <code><a href="http://www.w3.org/ns/csvw.jsonld">http://www.w3.org/ns/csvw.jsonld</a></code> is used with metadata documents. When used within a metadata document,
        the context can be referenced as <code>http://www.w3.org/ns/csvw</code>.
        See [[csvw-context]] for a full description of defined terms and prefixes. This context may be updated from time-to-time to define new terms and prefixes.
      </p>
    </section>
  </body>
</html>

